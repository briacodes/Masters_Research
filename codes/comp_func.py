#Run before in terminal: module load license_intel intel hdf hdf5 netcdf4 miniconda

###     This code makes a single txt file with all the comparable information from co-located VIIRS,	###
###     DR, and CO2 Slicing. This is used to compare the three, and make anaysis easier. ecmwf_ CD    	###
###	can also be added if we see fit.								###

import matplotlib
matplotlib.use("AGG")
import matplotlib.pyplot as plt
import numpy as np
import os
import sys
import cartopy
import cartopy.crs as ccrs
import matplotlib.colors as colors
import matplotlib.patches as patches
import matplotlib.ticker as mticker
from numpy import loadtxt
from cartopy.mpl.gridliner import LONGITUDE_FORMATTER, LATITUDE_FORMATTER
from datetime import date
from shutil import copyfile
import shutil
import netCDF4 as cdf
from glob import glob

#full_comps(st1,sp1,dt1,dt2,mon1,ye1) is used for making a comp file with all 4 algorithms at each hour
#full_comps_parts(st1,sp1,dt1,dt2,mon1,ye1) is used for making a comp file with CO2 Slcing and NCEP at each hour
#comps_hour(dt1,mon1,ye1) is for making comp file for full day with all 4 algorithms
#comps_hour_parts(dt1,mon1,ye1) is for making comp file for full day with CO2 Slicing and NCEP

def full_comps(st1,sp1,dt1,dt2,mon1,ye1):
 b1=int(st1)
 b2=int(sp1)
 b3=int(dt1)
 b4=int(dt2)
 b5=int(mon1)
 b6=int(ye1)
 if b1>=0 and b1<=9:
  c1="0"+str(b1)
 else:
  c1=str(b1)
 if b2>=0 and b2<=9:
  c2="0"+str(b2)
 else:
  c2=str(b2)
 if b3>=0 and b3<=9:
  c3="0"+str(b3)
 else:
  c3=str(b3)
 if b4>=0 and b4<=9:
  c4="0"+str(b4)
 else:
  c4=str(b4)
 if b5>=0 and b5<=9:
  c5="0"+str(b5)
 else:
  c5=str(b5)
 c6=str(b6)
 st=c1
 sp=c2
 dt=c3
 dp=c4
 mon=c5
 yer=c6
 day_time=(yer+"_"+mon+"_"+dt+"_"+st+"_"+sp)
 filepath=("/apollo/jung/bandersen")
 file_dr=(filepath+"/txt_dr_output_"+yer+"_"+mon+"_"+dt+"/dr_"+yer+"_"+mon+"_"+dt+"_"+st+"_"+sp+".txt")
 array_dr=loadtxt(file_dr,comments='#',delimiter=',',unpack=True)
 file_ecm=(filepath+"/ecmwf_data_output_txt_"+yer+'_'+mon+'_'+dt+'/ecmwf_cd_'+yer+mon+dt+'_'+st+'_'+sp+'_n20.txt')
 array_ecm=loadtxt(file_ecm,comments='#',delimiter=',',unpack=True)
 file_co2=(filepath+"/co2_slicing_full/"+yer+"_"+mon+"_"+dt+"/co2_slicing_output_"+yer+"_"+mon+"_"+dt+"_"+st+"00_"+st+"30.txt")
 array_co2_1=loadtxt(file_co2,comments='#',delimiter=',',unpack=True)
 file_co2=(filepath+"/co2_slicing_full/"+yer+"_"+mon+"_"+dt+"/co2_slicing_output_"+yer+"_"+mon+"_"+dt+"_"+st+"30_"+sp+"00.txt")
 array_co2_2=loadtxt(file_co2,comments='#',delimiter=',',unpack=True)
 array_ncep_1=cdf.Dataset(filepath+'/ncep_data_'+yer+'_'+mon+'_'+dt+'/cris.431.n20.'+yer+mon+dt+"_"+st+"0000."+yer+mon+dt+"_"+st+"3000.ncep.nc")
 array_ncep_2=cdf.Dataset(filepath+'/ncep_data_'+yer+'_'+mon+'_'+dt+'/cris.431.n20.'+yer+mon+dt+"_"+st+"3000."+yer+mon+dp+"_"+sp+"0000.ncep.nc")
 output=(filepath+"/compare_full/co2_dr_ncep_ecmwf_output_"+day_time+".txt")
 lat_ecm=array_ecm[0][:]
 lon_ecm=array_ecm[1][:]
 cld_ecm_28=array_ecm[30][:]
 cld_ecm_30=array_ecm[32][:]
 cld_ecm_32=array_ecm[34][:]
 cld_ecm_34=array_ecm[36][:]
 cld_ecm_36=array_ecm[38][:]
 cld_ecm_49=array_ecm[51][:]
 cld_ecm_51=array_ecm[53][:]
 cld_ecm_53=array_ecm[55][:]
 cld_ecm_55=array_ecm[57][:]
 cld_ecm_57=array_ecm[59][:]
 cld_ecm_65=array_ecm[67][:]
 cld_ecm_67=array_ecm[69][:]
 cld_ecm_69=array_ecm[71][:]
 cld_ecm_71=array_ecm[73][:]
 cld_ecm_73=array_ecm[75][:]
 cld_ecm_94=array_ecm[96][:]
 cld_ecm_96=array_ecm[98][:]
 cld_ecm_98=array_ecm[100][:]
 cld_ecm_100=array_ecm[102][:]
 cld_ecm_102=array_ecm[104][:]
 cld_ecm_122=array_ecm[124][:]
 cld_ecm_216=array_ecm[218][:]
 lat_dr=array_dr[0][:]
 lon_dr=array_dr[1][:]
 cot_dr=array_dr[2][:]
 ctp_dr=array_dr[3][:]
 size_dr=np.size(lat_dr)
 ncep_1=array_ncep_1['lat'][:]
 ncep_2=array_ncep_2['lat'][:]
 lat_ncep=np.asarray(np.concatenate((ncep_1,ncep_2)))
 ncep_1=array_ncep_1['lon'][:]
 ncep_2=array_ncep_2['lon'][:]
 lon_ncep=np.asarray(np.concatenate((ncep_1,ncep_2)))
 ctp_ncep_1=array_ncep_1['ctp'][:]
 ctp_ncep_2=array_ncep_2['ctp'][:]
 ctp_ncep=np.asarray(np.concatenate((ctp_ncep_1,ctp_ncep_2)))
 cldfrac_ncep_1=array_ncep_1['cldfrac'][:]
 cldfrac_ncep_2=array_ncep_2['cldfrac'][:]
 cot_ncep=np.asarray(np.concatenate((cldfrac_ncep_1,cldfrac_ncep_2)))
 sum3_ncep_1=array_ncep_1['sum3'][:]
 sum3_ncep_2=array_ncep_2['sum3'][:]
 sum3_ncep=np.asarray(np.concatenate((sum3_ncep_1,sum3_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,28]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,28]
 ctag_ncep_28=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,30]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,30]
 ctag_ncep_30=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,32]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,32]
 ctag_ncep_32=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,34]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,34]
 ctag_ncep_34=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,36]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,36]
 ctag_ncep_36=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,49]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,49]
 ctag_ncep_49=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,51]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,51]
 ctag_ncep_51=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,53]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,53]
 ctag_ncep_53=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,55]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,55]
 ctag_ncep_55=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,57]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,57]
 ctag_ncep_57=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,65]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,65]
 ctag_ncep_65=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,67]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,67]
 ctag_ncep_67=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,69]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,69]
 ctag_ncep_69=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,71]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,71]
 ctag_ncep_71=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,73]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,73]
 ctag_ncep_73=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,94]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,94]
 ctag_ncep_94=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,96]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,96]
 ctag_ncep_96=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,98]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,98]
 ctag_ncep_98=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,100]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,100]
 ctag_ncep_100=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,102]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,102]
 ctag_ncep_102=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,122]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,122]
 ctag_ncep_122=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,216]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,216]
 ctag_ncep_216=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 lat_co2=np.asarray(np.concatenate((array_co2_1[0][:],array_co2_2[0][:])))
 lon_co2=np.asarray(np.concatenate((array_co2_1[1][:],array_co2_2[1][:])))
 topo=np.asarray(np.concatenate((array_co2_1[2][:],array_co2_2[2][:])))
 forr=np.asarray(np.concatenate((array_co2_1[3][:],array_co2_2[3][:])))
 fovv=np.asarray(np.concatenate((array_co2_1[4][:],array_co2_2[4][:])))
 ctp_viirs=np.asarray(np.concatenate((array_co2_1[5][:],array_co2_2[5][:])))
 cot_viirs=np.asarray(np.concatenate((array_co2_1[6][:],array_co2_2[6][:])))
 ctp_co2=np.asarray(np.concatenate((array_co2_1[7][:],array_co2_2[7][:])))
 cot_co2=np.asarray(np.concatenate((array_co2_1[8][:],array_co2_2[8][:])))
 lev_co2=np.asarray(np.concatenate((array_co2_1[9][:],array_co2_2[9][:])))
 trop=np.asarray(np.concatenate((array_co2_1[10][:],array_co2_2[10][:])))
 ir_test=np.asarray(np.concatenate((array_co2_1[11][:],array_co2_2[11][:])))
 co2_use_28=np.asarray(np.concatenate((array_co2_1[12][:],array_co2_2[12][:])))
 co2_use_30=np.asarray(np.concatenate((array_co2_1[13][:],array_co2_2[13][:])))
 co2_use_32=np.asarray(np.concatenate((array_co2_1[14][:],array_co2_2[14][:])))
 co2_use_34=np.asarray(np.concatenate((array_co2_1[15][:],array_co2_2[15][:])))
 co2_use_36=np.asarray(np.concatenate((array_co2_1[16][:],array_co2_2[16][:])))
 co2_use_49=np.asarray(np.concatenate((array_co2_1[17][:],array_co2_2[17][:])))
 co2_use_51=np.asarray(np.concatenate((array_co2_1[18][:],array_co2_2[18][:])))
 co2_use_53=np.asarray(np.concatenate((array_co2_1[19][:],array_co2_2[19][:])))
 co2_use_55=np.asarray(np.concatenate((array_co2_1[20][:],array_co2_2[20][:])))
 co2_use_57=np.asarray(np.concatenate((array_co2_1[21][:],array_co2_2[21][:])))
 co2_use_65=np.asarray(np.concatenate((array_co2_1[22][:],array_co2_2[22][:])))
 co2_use_67=np.asarray(np.concatenate((array_co2_1[23][:],array_co2_2[23][:])))
 co2_use_69=np.asarray(np.concatenate((array_co2_1[24][:],array_co2_2[24][:])))
 co2_use_71=np.asarray(np.concatenate((array_co2_1[25][:],array_co2_2[25][:])))
 co2_use_73=np.asarray(np.concatenate((array_co2_1[26][:],array_co2_2[26][:])))
 co2_use_94=np.asarray(np.concatenate((array_co2_1[27][:],array_co2_2[27][:])))
 co2_use_96=np.asarray(np.concatenate((array_co2_1[28][:],array_co2_2[28][:])))
 co2_use_98=np.asarray(np.concatenate((array_co2_1[29][:],array_co2_2[29][:])))
 co2_use_100=np.asarray(np.concatenate((array_co2_1[30][:],array_co2_2[30][:])))
 co2_use_102=np.asarray(np.concatenate((array_co2_1[31][:],array_co2_2[31][:])))
 co2_use_122=np.asarray(np.concatenate((array_co2_1[32][:],array_co2_2[32][:])))
 crtm_obs_28=np.asarray(np.concatenate((array_co2_1[33][:],array_co2_2[33][:])))
 crtm_obs_30=np.asarray(np.concatenate((array_co2_1[34][:],array_co2_2[34][:])))
 crtm_obs_32=np.asarray(np.concatenate((array_co2_1[35][:],array_co2_2[35][:])))
 crtm_obs_34=np.asarray(np.concatenate((array_co2_1[36][:],array_co2_2[36][:])))
 crtm_obs_36=np.asarray(np.concatenate((array_co2_1[37][:],array_co2_2[37][:])))
 crtm_obs_49=np.asarray(np.concatenate((array_co2_1[38][:],array_co2_2[38][:])))
 crtm_obs_51=np.asarray(np.concatenate((array_co2_1[39][:],array_co2_2[39][:])))
 crtm_obs_53=np.asarray(np.concatenate((array_co2_1[40][:],array_co2_2[40][:])))
 crtm_obs_55=np.asarray(np.concatenate((array_co2_1[41][:],array_co2_2[41][:])))
 crtm_obs_57=np.asarray(np.concatenate((array_co2_1[42][:],array_co2_2[42][:])))
 crtm_obs_65=np.asarray(np.concatenate((array_co2_1[43][:],array_co2_2[43][:])))
 crtm_obs_67=np.asarray(np.concatenate((array_co2_1[44][:],array_co2_2[44][:])))
 crtm_obs_69=np.asarray(np.concatenate((array_co2_1[45][:],array_co2_2[45][:])))
 crtm_obs_71=np.asarray(np.concatenate((array_co2_1[46][:],array_co2_2[46][:])))
 crtm_obs_73=np.asarray(np.concatenate((array_co2_1[47][:],array_co2_2[47][:])))
 crtm_obs_94=np.asarray(np.concatenate((array_co2_1[48][:],array_co2_2[48][:])))
 crtm_obs_96=np.asarray(np.concatenate((array_co2_1[49][:],array_co2_2[49][:])))
 crtm_obs_98=np.asarray(np.concatenate((array_co2_1[50][:],array_co2_2[50][:])))
 crtm_obs_100=np.asarray(np.concatenate((array_co2_1[51][:],array_co2_2[51][:])))
 crtm_obs_102=np.asarray(np.concatenate((array_co2_1[52][:],array_co2_2[52][:])))
 crtm_obs_122=np.asarray(np.concatenate((array_co2_1[53][:],array_co2_2[53][:])))
 crtm_obs_216=np.asarray(np.concatenate((array_co2_1[54][:],array_co2_2[54][:])))
 obs_28=np.asarray(np.concatenate((array_co2_1[55][:],array_co2_2[55][:])))
 obs_30=np.asarray(np.concatenate((array_co2_1[56][:],array_co2_2[56][:])))
 obs_32=np.asarray(np.concatenate((array_co2_1[57][:],array_co2_2[57][:])))
 obs_34=np.asarray(np.concatenate((array_co2_1[58][:],array_co2_2[58][:])))
 obs_36=np.asarray(np.concatenate((array_co2_1[59][:],array_co2_2[59][:])))
 obs_49=np.asarray(np.concatenate((array_co2_1[60][:],array_co2_2[60][:])))
 obs_51=np.asarray(np.concatenate((array_co2_1[61][:],array_co2_2[61][:])))
 obs_53=np.asarray(np.concatenate((array_co2_1[62][:],array_co2_2[62][:])))
 obs_55=np.asarray(np.concatenate((array_co2_1[63][:],array_co2_2[63][:])))
 obs_57=np.asarray(np.concatenate((array_co2_1[64][:],array_co2_2[64][:])))
 obs_65=np.asarray(np.concatenate((array_co2_1[65][:],array_co2_2[65][:])))
 obs_67=np.asarray(np.concatenate((array_co2_1[66][:],array_co2_2[66][:])))
 obs_69=np.asarray(np.concatenate((array_co2_1[67][:],array_co2_2[67][:])))
 obs_71=np.asarray(np.concatenate((array_co2_1[68][:],array_co2_2[68][:])))
 obs_73=np.asarray(np.concatenate((array_co2_1[69][:],array_co2_2[69][:])))
 obs_94=np.asarray(np.concatenate((array_co2_1[70][:],array_co2_2[70][:])))
 obs_96=np.asarray(np.concatenate((array_co2_1[71][:],array_co2_2[71][:])))
 obs_98=np.asarray(np.concatenate((array_co2_1[72][:],array_co2_2[72][:])))
 obs_100=np.asarray(np.concatenate((array_co2_1[73][:],array_co2_2[73][:])))
 obs_102=np.asarray(np.concatenate((array_co2_1[74][:],array_co2_2[74][:])))
 obs_122=np.asarray(np.concatenate((array_co2_1[75][:],array_co2_2[75][:])))
 obs_216=np.asarray(np.concatenate((array_co2_1[76][:],array_co2_2[76][:])))
 def find_nearest(array,value):
  array=np.asarray(array)
  idx=(np.abs(array-value)).argmin()
  return array[idx]
 def find_nearest_index(array,value):
  array=np.asarray(array)
  idx=(np.abs(array-value)).argmin()
  return(idx)
 lat_all=[]
 lon_all=[]
 topo_all=[]
 for_all=[]
 fov_all=[]
 lev_all=[]
 trop_all=[]
 ir_all=[]
 co2_ctp_all=[]
 dr_ctp_all=[]
 viirs_ctp_all=[]
 ncep_ctp_all=[]
 co2_cot_all=[]
 dr_cot_all=[]
 viirs_cot_all=[]
 ncep_cot_all=[]
 ncep_sum3_all=[]
 co2_28_all=[]
 co2_30_all=[]
 co2_32_all=[]
 co2_34_all=[]
 co2_36_all=[]
 co2_49_all=[]
 co2_51_all=[]
 co2_53_all=[]
 co2_55_all=[]
 co2_57_all=[]
 co2_65_all=[]
 co2_67_all=[]
 co2_69_all=[]
 co2_71_all=[]
 co2_73_all=[]
 co2_94_all=[]
 co2_96_all=[]
 co2_98_all=[]
 co2_100_all=[]
 co2_102_all=[]
 co2_122_all=[]
 ncep_28_all=[]
 ncep_30_all=[]
 ncep_32_all=[]
 ncep_34_all=[]
 ncep_36_all=[]
 ncep_49_all=[]
 ncep_51_all=[]
 ncep_53_all=[]
 ncep_55_all=[]
 ncep_57_all=[]
 ncep_65_all=[]
 ncep_67_all=[]
 ncep_69_all=[]
 ncep_71_all=[]
 ncep_73_all=[]
 ncep_94_all=[]
 ncep_96_all=[]
 ncep_98_all=[]
 ncep_100_all=[]
 ncep_102_all=[]
 ncep_122_all=[]
 ncep_216_all=[]
 emc_28_all=[]
 emc_30_all=[]
 emc_32_all=[]
 emc_34_all=[]
 emc_36_all=[]
 emc_49_all=[]
 emc_51_all=[]
 emc_53_all=[]
 emc_55_all=[]
 emc_57_all=[]
 emc_65_all=[]
 emc_67_all=[]
 emc_69_all=[]
 emc_71_all=[]
 emc_73_all=[]
 emc_94_all=[]
 emc_96_all=[]
 emc_98_all=[]
 emc_100_all=[]
 emc_102_all=[]
 emc_122_all=[]
 emc_216_all=[]
 crtm_obs_28_all=[]
 crtm_obs_30_all=[]
 crtm_obs_32_all=[]
 crtm_obs_34_all=[]
 crtm_obs_36_all=[]
 crtm_obs_49_all=[]
 crtm_obs_51_all=[]
 crtm_obs_53_all=[]
 crtm_obs_55_all=[]
 crtm_obs_57_all=[]
 crtm_obs_65_all=[]
 crtm_obs_67_all=[]
 crtm_obs_69_all=[]
 crtm_obs_71_all=[]
 crtm_obs_73_all=[]
 crtm_obs_94_all=[]
 crtm_obs_96_all=[]
 crtm_obs_98_all=[]
 crtm_obs_100_all=[]
 crtm_obs_102_all=[]
 crtm_obs_122_all=[]
 crtm_obs_216_all=[]
 obs_28_all=[]
 obs_30_all=[]
 obs_32_all=[]
 obs_34_all=[]
 obs_36_all=[]
 obs_49_all=[]
 obs_51_all=[]
 obs_53_all=[]
 obs_55_all=[]
 obs_57_all=[]
 obs_65_all=[]
 obs_67_all=[]
 obs_69_all=[]
 obs_71_all=[]
 obs_73_all=[]
 obs_94_all=[]
 obs_96_all=[]
 obs_98_all=[]
 obs_100_all=[]
 obs_102_all=[]
 obs_122_all=[]
 obs_216_all=[]
 for a1 in range(0,size_dr):
  a_val=find_nearest(lat_co2,lat_dr[a1])
  a_dr=find_nearest_index(lat_dr,a_val)
  a_co2=find_nearest_index(lat_co2,a_val)
  a_ncep=find_nearest_index(lat_ncep,a_val)
  a_ecm=find_nearest_index(lat_ecm,a_val)
  b1=lat_dr[a_dr]
  b2=lon_dr[a_dr]
  c1=topo[a_co2]
  c2=forr[a_co2]
  c3=fovv[a_co2]
  d1=lev_co2[a_co2]
  d2=trop[a_co2]
  d3=ir_test[a_co2]
  d4=sum3_ncep[a_ncep]
  e1=ctp_co2[a_co2]
  e2=ctp_dr[a_dr]
  e3=ctp_viirs[a_co2]
  e4=ctp_ncep[a_ncep]
  g1=cot_co2[a_co2]
  g2=cot_dr[a_dr]
  g3=cot_viirs[a_co2]
  g4=cot_ncep[a_ncep]
  h1=co2_use_28[a_co2]
  h2=co2_use_30[a_co2]
  h3=co2_use_32[a_co2]
  h4=co2_use_34[a_co2]
  h5=co2_use_36[a_co2]
  h6=co2_use_49[a_co2]
  h7=co2_use_51[a_co2]
  h8=co2_use_53[a_co2]
  h9=co2_use_55[a_co2]
  h10=co2_use_57[a_co2]
  h11=co2_use_65[a_co2]
  h12=co2_use_67[a_co2]
  h13=co2_use_69[a_co2]
  h14=co2_use_71[a_co2]
  h15=co2_use_73[a_co2]
  h16=co2_use_94[a_co2]
  h17=co2_use_96[a_co2]
  h18=co2_use_98[a_co2]
  h19=co2_use_100[a_co2]
  h20=co2_use_102[a_co2]
  h21=co2_use_122[a_co2]
  j1=ctag_ncep_28[a_ncep]
  j2=ctag_ncep_30[a_ncep]
  j3=ctag_ncep_32[a_ncep]
  j4=ctag_ncep_34[a_ncep]
  j5=ctag_ncep_36[a_ncep]
  j6=ctag_ncep_49[a_ncep]
  j7=ctag_ncep_51[a_ncep]
  j8=ctag_ncep_53[a_ncep]
  j9=ctag_ncep_55[a_ncep]
  j10=ctag_ncep_57[a_ncep]
  j11=ctag_ncep_65[a_ncep]
  j12=ctag_ncep_67[a_ncep]
  j13=ctag_ncep_69[a_ncep]
  j14=ctag_ncep_71[a_ncep]
  j15=ctag_ncep_73[a_ncep]
  j16=ctag_ncep_94[a_ncep]
  j17=ctag_ncep_96[a_ncep]
  j18=ctag_ncep_98[a_ncep]
  j19=ctag_ncep_100[a_ncep]
  j20=ctag_ncep_102[a_ncep]
  j21=ctag_ncep_122[a_ncep]
  j22=ctag_ncep_216[a_ncep]
  k1=cld_ecm_28[a_ecm]
  k2=cld_ecm_30[a_ecm]
  k3=cld_ecm_32[a_ecm]
  k4=cld_ecm_34[a_ecm]
  k5=cld_ecm_36[a_ecm]
  k6=cld_ecm_49[a_ecm]
  k7=cld_ecm_51[a_ecm]
  k8=cld_ecm_53[a_ecm]
  k9=cld_ecm_55[a_ecm]
  k10=cld_ecm_57[a_ecm]
  k11=cld_ecm_65[a_ecm]
  k12=cld_ecm_67[a_ecm]
  k13=cld_ecm_69[a_ecm]
  k14=cld_ecm_71[a_ecm]
  k15=cld_ecm_73[a_ecm]
  k16=cld_ecm_94[a_ecm]
  k17=cld_ecm_96[a_ecm]
  k18=cld_ecm_98[a_ecm]
  k19=cld_ecm_100[a_ecm]
  k20=cld_ecm_102[a_ecm]
  k21=cld_ecm_122[a_ecm]
  k22=cld_ecm_216[a_ecm]
  l1=crtm_obs_28[a_co2]
  l2=crtm_obs_30[a_co2]
  l3=crtm_obs_32[a_co2]
  l4=crtm_obs_34[a_co2]
  l5=crtm_obs_36[a_co2]
  l6=crtm_obs_49[a_co2]
  l7=crtm_obs_51[a_co2]
  l8=crtm_obs_53[a_co2]
  l9=crtm_obs_55[a_co2]
  l10=crtm_obs_57[a_co2]
  l11=crtm_obs_65[a_co2]
  l12=crtm_obs_67[a_co2]
  l13=crtm_obs_69[a_co2]
  l14=crtm_obs_71[a_co2]
  l15=crtm_obs_73[a_co2]
  l16=crtm_obs_94[a_co2]
  l17=crtm_obs_96[a_co2]
  l18=crtm_obs_98[a_co2]
  l19=crtm_obs_100[a_co2]
  l20=crtm_obs_102[a_co2]
  l21=crtm_obs_122[a_co2]
  l22=crtm_obs_216[a_co2]
  m1=obs_28[a_co2]
  m2=obs_30[a_co2]
  m3=obs_32[a_co2]
  m4=obs_34[a_co2]
  m5=obs_36[a_co2]
  m6=obs_49[a_co2]
  m7=obs_51[a_co2]
  m8=obs_53[a_co2]
  m9=obs_55[a_co2]
  m10=obs_57[a_co2]
  m11=obs_65[a_co2]
  m12=obs_67[a_co2]
  m13=obs_69[a_co2]
  m14=obs_71[a_co2]
  m15=obs_73[a_co2]
  m16=obs_94[a_co2]
  m17=obs_96[a_co2]
  m18=obs_98[a_co2]
  m19=obs_100[a_co2]
  m20=obs_102[a_co2]
  m21=obs_122[a_co2]
  m22=obs_216[a_co2]
  lat_all.append(b1)
  lon_all.append(b2)
  topo_all.append(c1)
  for_all.append(c2)
  fov_all.append(c3)
  lev_all.append(d1)
  trop_all.append(d2)
  ir_all.append(d3)
  ncep_sum3_all.append(d4)
  co2_ctp_all.append(e1)
  dr_ctp_all.append(e2)
  viirs_ctp_all.append(e3)
  ncep_ctp_all.append(e4)
  co2_cot_all.append(g1)
  dr_cot_all.append(g2)
  viirs_cot_all.append(g3)
  ncep_cot_all.append(g4)
  co2_28_all.append(h1)
  co2_30_all.append(h2)
  co2_32_all.append(h3)
  co2_34_all.append(h4)
  co2_36_all.append(h5)
  co2_49_all.append(h6)
  co2_51_all.append(h7)
  co2_53_all.append(h8)
  co2_55_all.append(h9)
  co2_57_all.append(h10)
  co2_65_all.append(h11)
  co2_67_all.append(h12)
  co2_69_all.append(h13)
  co2_71_all.append(h14)
  co2_73_all.append(h15)
  co2_94_all.append(h16)
  co2_96_all.append(h17)
  co2_98_all.append(h18)
  co2_100_all.append(h19)
  co2_102_all.append(h20)
  co2_122_all.append(h21)
  ncep_28_all.append(j1)
  ncep_30_all.append(j2)
  ncep_32_all.append(j3)
  ncep_34_all.append(j4)
  ncep_36_all.append(j5)
  ncep_49_all.append(j6)
  ncep_51_all.append(j7)
  ncep_53_all.append(j8)
  ncep_55_all.append(j9)
  ncep_57_all.append(j10)
  ncep_65_all.append(j11)
  ncep_67_all.append(j12)
  ncep_69_all.append(j13)
  ncep_71_all.append(j14)
  ncep_73_all.append(j15)
  ncep_94_all.append(j16)
  ncep_96_all.append(j17)
  ncep_98_all.append(j18)
  ncep_100_all.append(j19)
  ncep_102_all.append(j20)
  ncep_122_all.append(j21)
  ncep_216_all.append(j22)
  emc_28_all.append(k1)
  emc_30_all.append(k2)
  emc_32_all.append(k3)
  emc_34_all.append(k4)
  emc_36_all.append(k5)
  emc_49_all.append(k6)
  emc_51_all.append(k7)
  emc_53_all.append(k8)
  emc_55_all.append(k9)
  emc_57_all.append(k10)
  emc_65_all.append(k11)
  emc_67_all.append(k12)
  emc_69_all.append(k13)
  emc_71_all.append(k14)
  emc_73_all.append(k15)
  emc_94_all.append(k16)
  emc_96_all.append(k17)
  emc_98_all.append(k18)
  emc_100_all.append(k19)
  emc_102_all.append(k20)
  emc_122_all.append(k21)
  emc_216_all.append(k22)
  crtm_obs_28_all.append(l1)
  crtm_obs_30_all.append(l2)
  crtm_obs_32_all.append(l3)
  crtm_obs_34_all.append(l4)
  crtm_obs_36_all.append(l5)
  crtm_obs_49_all.append(l6)
  crtm_obs_51_all.append(l7)
  crtm_obs_53_all.append(l8)
  crtm_obs_55_all.append(l9)
  crtm_obs_57_all.append(l10)
  crtm_obs_65_all.append(l11)
  crtm_obs_67_all.append(l12)
  crtm_obs_69_all.append(l13)
  crtm_obs_71_all.append(l14)
  crtm_obs_73_all.append(l15)
  crtm_obs_94_all.append(l16)
  crtm_obs_96_all.append(l17)
  crtm_obs_98_all.append(l18)
  crtm_obs_100_all.append(l19)
  crtm_obs_102_all.append(l20)
  crtm_obs_122_all.append(l21)
  crtm_obs_216_all.append(l22)
  obs_28_all.append(m1)
  obs_30_all.append(m2)
  obs_32_all.append(m3)
  obs_34_all.append(m4)
  obs_36_all.append(m5)
  obs_49_all.append(m6)
  obs_51_all.append(m7)
  obs_53_all.append(m8)
  obs_55_all.append(m9)
  obs_57_all.append(m10)
  obs_65_all.append(m11)
  obs_67_all.append(m12)
  obs_69_all.append(m13)
  obs_71_all.append(m14)
  obs_73_all.append(m15)
  obs_94_all.append(m16)
  obs_96_all.append(m17)
  obs_98_all.append(m18)
  obs_100_all.append(m19)
  obs_102_all.append(m20)
  obs_122_all.append(m21)
  obs_216_all.append(m22)
 size=np.size(lat_all)
 file=open(output,"w+")
 with open(output,'wb') as f:
  for a in range(0,size):
   z=np.array([lat_all[a],lon_all[a],topo_all[a],for_all[a],fov_all[a],lev_all[a],trop_all[a],ir_all[a],ncep_sum3_all[a],co2_ctp_all[a],dr_ctp_all[a],viirs_ctp_all[a],ncep_ctp_all[a],co2_cot_all[a],dr_cot_all[a],viirs_cot_all[a],ncep_cot_all[a],co2_28_all[a],co2_30_all[a],co2_32_all[a],co2_34_all[a],co2_36_all[a],co2_49_all[a],co2_51_all[a],co2_53_all[a],co2_55_all[a],co2_57_all[a],co2_65_all[a],co2_67_all[a],co2_69_all[a],co2_71_all[a],co2_73_all[a],co2_94_all[a],co2_96_all[a],co2_98_all[a],co2_100_all[a],co2_102_all[a],co2_122_all[a],ncep_28_all[a],ncep_30_all[a],ncep_32_all[a],ncep_34_all[a],ncep_36_all[a],ncep_49_all[a],ncep_51_all[a],ncep_53_all[a],ncep_55_all[a],ncep_57_all[a],ncep_65_all[a],ncep_67_all[a],ncep_69_all[a],ncep_71_all[a],ncep_73_all[a],ncep_94_all[a],ncep_96_all[a],ncep_98_all[a],ncep_100_all[a],ncep_102_all[a],ncep_122_all[a],ncep_216_all[a],emc_28_all[a],emc_30_all[a],emc_32_all[a],emc_34_all[a],emc_36_all[a],emc_49_all[a],emc_51_all[a],emc_53_all[a],emc_55_all[a],emc_57_all[a],emc_65_all[a],emc_67_all[a],emc_69_all[a],emc_71_all[a],emc_73_all[a],emc_94_all[a],emc_96_all[a],emc_98_all[a],emc_100_all[a],emc_102_all[a],emc_122_all[a],emc_216_all[a],crtm_obs_28_all[a],crtm_obs_30_all[a],crtm_obs_32_all[a],crtm_obs_34_all[a],crtm_obs_36_all[a],crtm_obs_49_all[a],crtm_obs_51_all[a],crtm_obs_53_all[a],crtm_obs_55_all[a],crtm_obs_57_all[a],crtm_obs_65_all[a],crtm_obs_67_all[a],crtm_obs_69_all[a],crtm_obs_71_all[a],crtm_obs_73_all[a],crtm_obs_94_all[a],crtm_obs_96_all[a],crtm_obs_98_all[a],crtm_obs_100_all[a],crtm_obs_102_all[a],crtm_obs_122_all[a],crtm_obs_216_all[a],obs_28_all[a],obs_30_all[a],obs_32_all[a],obs_34_all[a],obs_36_all[a],obs_49_all[a],obs_51_all[a],obs_53_all[a],obs_55_all[a],obs_57_all[a],obs_65_all[a],obs_67_all[a],obs_69_all[a],obs_71_all[a],obs_73_all[a],obs_94_all[a],obs_96_all[a],obs_98_all[a],obs_100_all[a],obs_102_all[a],obs_122_all[a],obs_216_all[a]])
   np.savetxt(f,z,fmt='%1.7f',newline=" ")
   np.savetxt(f,[-8888],fmt='%d',newline=" ")
 f.close()
 f=open(output,"rt")
 r=f.read()
 r=r.replace("-8888","\n")
 r=r.replace(" -","-")
 r=r.replace("ift","797979")
 r=r.replace("inf","797979")
 r=r.replace("nan","-9999")
 r=r.replace(" ",",")
 r=r.replace(","+"\n","\n")
 r=r.replace("\n"+",","\n")
 r=r.replace("0-","0,-")
 r=r.replace("1-","1,-")
 r=r.replace("2-","2,-")
 r=r.replace("3-","3,-")
 r=r.replace("4-","4,-")
 r=r.replace("5-","5,-")
 r=r.replace("6-","6,-")
 r=r.replace("7-","7,-")
 r=r.replace("8-","8,-")
 r=r.replace("9-","9,-")
 f.close()
 f=open(output,"wt")
 f.write(r)
 f.close()
 return("done")


def comps_hour(dt1,mon1,ye1):
 b1=int(dt1)
 b2=int(mon1)
 b3=int(ye1)
 if b1>=0 and b1<=9:
  c1="0"+str(b1)
 else:
  c1=str(b1)
 if b2>=0 and b2<=9:
  c2="0"+str(b2)
 else:
  c2=str(b2)
 c3=str(b3)
 dd=c1
 mon=c2
 yer=c3
 output1=('/apollo/jung/bandersen/compare_full_no_parts/co2_dr_ncep_ecmwf_output_'+yer+'_'+mon+'_'+dd+'_24hr.txt')
 files=glob('/apollo/jung/bandersen/compare_full/co2_dr_ncep_ecmwf_output_'+yer+'_'+mon+'_'+dd+'*.txt')[:]
 sizer=np.size(files)
 lat=[]
 lon=[]
 topo=[]
 forr=[]
 fov=[]
 lev=[]
 trop=[]
 ir=[]
 sum3=[]
 ctpc=[]
 ctpd=[]
 ctpv=[]
 ctpn=[]
 cotc=[]
 cotd=[]
 cotv=[]
 cotn=[]
 co2_28=[]
 co2_30=[]
 co2_32=[]
 co2_34=[]
 co2_36=[]
 co2_49=[]
 co2_51=[]
 co2_53=[]
 co2_55=[]
 co2_57=[]
 co2_65=[]
 co2_67=[]
 co2_69=[]
 co2_71=[]
 co2_73=[]
 co2_94=[]
 co2_96=[]
 co2_98=[]
 co2_100=[]
 co2_102=[]
 co2_122=[]
 ncep_28=[]
 ncep_30=[]
 ncep_32=[]
 ncep_34=[]
 ncep_36=[]
 ncep_49=[]
 ncep_51=[]
 ncep_53=[]
 ncep_55=[]
 ncep_57=[]
 ncep_65=[]
 ncep_67=[]
 ncep_69=[]
 ncep_71=[]
 ncep_73=[]
 ncep_94=[]
 ncep_96=[]
 ncep_98=[]
 ncep_100=[]
 ncep_102=[]
 ncep_122=[]
 ncep_216=[]
 ecmwf_28=[]
 ecmwf_30=[]
 ecmwf_32=[]
 ecmwf_34=[]
 ecmwf_36=[]
 ecmwf_49=[]
 ecmwf_51=[]
 ecmwf_53=[]
 ecmwf_55=[]
 ecmwf_57=[]
 ecmwf_65=[]
 ecmwf_67=[]
 ecmwf_69=[]
 ecmwf_71=[]
 ecmwf_73=[]
 ecmwf_94=[]
 ecmwf_96=[]
 ecmwf_98=[]
 ecmwf_100=[]
 ecmwf_102=[]
 ecmwf_122=[]
 ecmwf_216=[]
 crtm_obs_28=[]
 crtm_obs_30=[]
 crtm_obs_32=[]
 crtm_obs_34=[]
 crtm_obs_36=[]
 crtm_obs_49=[]
 crtm_obs_51=[]
 crtm_obs_53=[]
 crtm_obs_55=[]
 crtm_obs_57=[]
 crtm_obs_65=[]
 crtm_obs_67=[]
 crtm_obs_69=[]
 crtm_obs_71=[]
 crtm_obs_73=[]
 crtm_obs_94=[]
 crtm_obs_96=[]
 crtm_obs_98=[]
 crtm_obs_100=[]
 crtm_obs_102=[]
 crtm_obs_122=[]
 crtm_obs_216=[]
 obs_28=[]
 obs_30=[]
 obs_32=[]
 obs_34=[]
 obs_36=[]
 obs_49=[]
 obs_51=[]
 obs_53=[]
 obs_55=[]
 obs_57=[]
 obs_65=[]
 obs_67=[]
 obs_69=[]
 obs_71=[]
 obs_73=[]
 obs_94=[]
 obs_96=[]
 obs_98=[]
 obs_100=[]
 obs_102=[]
 obs_122=[]
 obs_216=[]
 for i in range(0,sizer):
  array_a1=loadtxt(files[i],comments='#',delimiter=',',unpack=True)
  lat_a1=array_a1[0][:]
  lon_a1=array_a1[1][:]
  topo_a1=array_a1[2][:]
  forr_a1=array_a1[3][:]
  fov_a1=array_a1[4][:]
  lev_a1=array_a1[5][:]
  trop_a1=array_a1[6][:]
  ir_a1=array_a1[7][:]
  sum3_a1=array_a1[8][:]
  ctpc_a1=array_a1[9][:]
  ctpd_a1=array_a1[10][:]
  ctpv_a1=array_a1[11][:]
  ctpn_a1=array_a1[12][:]
  cotc_a1=array_a1[13][:]
  cotd_a1=array_a1[14][:]
  cotv_a1=array_a1[15][:]
  cotn_a1=array_a1[16][:]
  co2_28_a1=array_a1[17][:]
  co2_30_a1=array_a1[18][:]
  co2_32_a1=array_a1[19][:]
  co2_34_a1=array_a1[20][:]
  co2_36_a1=array_a1[21][:]
  co2_49_a1=array_a1[22][:]
  co2_51_a1=array_a1[23][:]
  co2_53_a1=array_a1[24][:]
  co2_55_a1=array_a1[25][:]
  co2_57_a1=array_a1[26][:]
  co2_65_a1=array_a1[27][:]
  co2_67_a1=array_a1[28][:]
  co2_69_a1=array_a1[29][:]
  co2_71_a1=array_a1[30][:]
  co2_73_a1=array_a1[31][:]
  co2_94_a1=array_a1[32][:]
  co2_96_a1=array_a1[33][:]
  co2_98_a1=array_a1[34][:]
  co2_100_a1=array_a1[35][:]
  co2_102_a1=array_a1[36][:]
  co2_122_a1=array_a1[37][:]
  ncep_28_a1=array_a1[38][:]
  ncep_30_a1=array_a1[39][:]
  ncep_32_a1=array_a1[40][:]
  ncep_34_a1=array_a1[41][:]
  ncep_36_a1=array_a1[42][:]
  ncep_49_a1=array_a1[43][:]
  ncep_51_a1=array_a1[44][:]
  ncep_53_a1=array_a1[45][:]
  ncep_55_a1=array_a1[46][:]
  ncep_57_a1=array_a1[47][:]
  ncep_65_a1=array_a1[48][:]
  ncep_67_a1=array_a1[49][:]
  ncep_69_a1=array_a1[50][:]
  ncep_71_a1=array_a1[51][:]
  ncep_73_a1=array_a1[52][:]
  ncep_94_a1=array_a1[53][:]
  ncep_96_a1=array_a1[54][:]
  ncep_98_a1=array_a1[55][:]
  ncep_100_a1=array_a1[56][:]
  ncep_102_a1=array_a1[57][:]
  ncep_122_a1=array_a1[58][:]
  ncep_216_a1=array_a1[59][:]
  ecmwf_28_a1=array_a1[60][:]
  ecmwf_30_a1=array_a1[61][:]
  ecmwf_32_a1=array_a1[62][:]
  ecmwf_34_a1=array_a1[63][:]
  ecmwf_36_a1=array_a1[64][:]
  ecmwf_49_a1=array_a1[65][:]
  ecmwf_51_a1=array_a1[66][:]
  ecmwf_53_a1=array_a1[67][:]
  ecmwf_55_a1=array_a1[68][:]
  ecmwf_57_a1=array_a1[69][:]
  ecmwf_65_a1=array_a1[70][:]
  ecmwf_67_a1=array_a1[71][:]
  ecmwf_69_a1=array_a1[72][:]
  ecmwf_71_a1=array_a1[73][:]
  ecmwf_73_a1=array_a1[74][:]
  ecmwf_94_a1=array_a1[75][:]
  ecmwf_96_a1=array_a1[76][:]
  ecmwf_98_a1=array_a1[77][:]
  ecmwf_100_a1=array_a1[78][:]
  ecmwf_102_a1=array_a1[79][:]
  ecmwf_122_a1=array_a1[80][:]
  ecmwf_216_a1=array_a1[81][:]
  crtm_obs_28_a1=array_a1[82][:]
  crtm_obs_30_a1=array_a1[83][:]
  crtm_obs_32_a1=array_a1[84][:]
  crtm_obs_34_a1=array_a1[85][:]
  crtm_obs_36_a1=array_a1[86][:]
  crtm_obs_49_a1=array_a1[87][:]
  crtm_obs_51_a1=array_a1[88][:]
  crtm_obs_53_a1=array_a1[89][:]
  crtm_obs_55_a1=array_a1[90][:]
  crtm_obs_57_a1=array_a1[91][:]
  crtm_obs_65_a1=array_a1[92][:]
  crtm_obs_67_a1=array_a1[93][:]
  crtm_obs_69_a1=array_a1[94][:]
  crtm_obs_71_a1=array_a1[95][:]
  crtm_obs_73_a1=array_a1[96][:]
  crtm_obs_94_a1=array_a1[97][:]
  crtm_obs_96_a1=array_a1[98][:]
  crtm_obs_98_a1=array_a1[99][:]
  crtm_obs_100_a1=array_a1[100][:]
  crtm_obs_102_a1=array_a1[101][:]
  crtm_obs_122_a1=array_a1[102][:]
  crtm_obs_216_a1=array_a1[103][:]
  obs_28_a1=array_a1[104][:]
  obs_30_a1=array_a1[105][:]
  obs_32_a1=array_a1[106][:]
  obs_34_a1=array_a1[107][:]
  obs_36_a1=array_a1[108][:]
  obs_49_a1=array_a1[109][:]
  obs_51_a1=array_a1[110][:]
  obs_53_a1=array_a1[111][:]
  obs_55_a1=array_a1[112][:]
  obs_57_a1=array_a1[113][:]
  obs_65_a1=array_a1[114][:]
  obs_67_a1=array_a1[115][:]
  obs_69_a1=array_a1[116][:]
  obs_71_a1=array_a1[117][:]
  obs_73_a1=array_a1[118][:]
  obs_94_a1=array_a1[119][:]
  obs_96_a1=array_a1[120][:]
  obs_98_a1=array_a1[121][:]
  obs_100_a1=array_a1[122][:]
  obs_102_a1=array_a1[123][:]
  obs_122_a1=array_a1[124][:]
  obs_216_a1=array_a1[125][:]
  lat=np.concatenate((lat,lat_a1))
  lon=np.concatenate((lon,lon_a1))
  topo=np.concatenate((topo,topo_a1))
  forr=np.concatenate((forr,forr_a1))
  fov=np.concatenate((fov,fov_a1))
  lev=np.concatenate((lev,lev_a1))
  trop=np.concatenate((trop,trop_a1))
  ir=np.concatenate((ir,ir_a1))
  sum3=np.concatenate((sum3,sum3_a1))
  ctpc=np.concatenate((ctpc,ctpc_a1))
  ctpd=np.concatenate((ctpd,ctpd_a1))
  ctpv=np.concatenate((ctpv,ctpv_a1))
  ctpn=np.concatenate((ctpn,ctpn_a1))
  cotc=np.concatenate((cotc,cotc_a1))
  cotd=np.concatenate((cotd,cotd_a1))
  cotv=np.concatenate((cotv,cotv_a1))
  cotn=np.concatenate((cotn,cotn_a1))
  co2_28=np.concatenate((co2_28,co2_28_a1))
  co2_30=np.concatenate((co2_30,co2_30_a1))
  co2_32=np.concatenate((co2_32,co2_32_a1))
  co2_34=np.concatenate((co2_34,co2_34_a1))
  co2_36=np.concatenate((co2_36,co2_36_a1))
  co2_49=np.concatenate((co2_49,co2_49_a1))
  co2_51=np.concatenate((co2_51,co2_51_a1))
  co2_53=np.concatenate((co2_53,co2_53_a1))
  co2_55=np.concatenate((co2_55,co2_55_a1))
  co2_57=np.concatenate((co2_57,co2_57_a1))
  co2_65=np.concatenate((co2_65,co2_65_a1))
  co2_67=np.concatenate((co2_67,co2_67_a1))
  co2_69=np.concatenate((co2_69,co2_69_a1))
  co2_71=np.concatenate((co2_71,co2_71_a1))
  co2_73=np.concatenate((co2_73,co2_73_a1))
  co2_94=np.concatenate((co2_94,co2_94_a1))
  co2_96=np.concatenate((co2_96,co2_96_a1))
  co2_98=np.concatenate((co2_98,co2_98_a1))
  co2_100=np.concatenate((co2_100,co2_100_a1))
  co2_102=np.concatenate((co2_102,co2_102_a1))
  co2_122=np.concatenate((co2_122,co2_122_a1))
  ncep_28=np.concatenate((ncep_28,ncep_28_a1))
  ncep_30=np.concatenate((ncep_30,ncep_30_a1))
  ncep_32=np.concatenate((ncep_32,ncep_32_a1))
  ncep_34=np.concatenate((ncep_34,ncep_34_a1))
  ncep_36=np.concatenate((ncep_36,ncep_36_a1))
  ncep_49=np.concatenate((ncep_49,ncep_49_a1))
  ncep_51=np.concatenate((ncep_51,ncep_51_a1))
  ncep_53=np.concatenate((ncep_53,ncep_53_a1))
  ncep_55=np.concatenate((ncep_55,ncep_55_a1))
  ncep_57=np.concatenate((ncep_57,ncep_57_a1))
  ncep_65=np.concatenate((ncep_65,ncep_65_a1))
  ncep_67=np.concatenate((ncep_67,ncep_67_a1))
  ncep_69=np.concatenate((ncep_69,ncep_69_a1))
  ncep_71=np.concatenate((ncep_71,ncep_71_a1))
  ncep_73=np.concatenate((ncep_73,ncep_73_a1))
  ncep_94=np.concatenate((ncep_94,ncep_94_a1))
  ncep_96=np.concatenate((ncep_96,ncep_96_a1))
  ncep_98=np.concatenate((ncep_98,ncep_98_a1))
  ncep_100=np.concatenate((ncep_100,ncep_100_a1))
  ncep_102=np.concatenate((ncep_102,ncep_102_a1))
  ncep_122=np.concatenate((ncep_122,ncep_122_a1))
  ncep_216=np.concatenate((ncep_216,ncep_216_a1))
  ecmwf_28=np.concatenate((ecmwf_28,ecmwf_28_a1))
  ecmwf_30=np.concatenate((ecmwf_30,ecmwf_30_a1))
  ecmwf_32=np.concatenate((ecmwf_32,ecmwf_32_a1))
  ecmwf_34=np.concatenate((ecmwf_34,ecmwf_34_a1))
  ecmwf_36=np.concatenate((ecmwf_36,ecmwf_36_a1))
  ecmwf_49=np.concatenate((ecmwf_49,ecmwf_49_a1))
  ecmwf_51=np.concatenate((ecmwf_51,ecmwf_51_a1))
  ecmwf_53=np.concatenate((ecmwf_53,ecmwf_53_a1))
  ecmwf_55=np.concatenate((ecmwf_55,ecmwf_55_a1))
  ecmwf_57=np.concatenate((ecmwf_57,ecmwf_57_a1))
  ecmwf_65=np.concatenate((ecmwf_65,ecmwf_65_a1))
  ecmwf_67=np.concatenate((ecmwf_67,ecmwf_67_a1))
  ecmwf_69=np.concatenate((ecmwf_69,ecmwf_69_a1))
  ecmwf_71=np.concatenate((ecmwf_71,ecmwf_71_a1))
  ecmwf_73=np.concatenate((ecmwf_73,ecmwf_73_a1))
  ecmwf_94=np.concatenate((ecmwf_94,ecmwf_94_a1))
  ecmwf_96=np.concatenate((ecmwf_96,ecmwf_96_a1))
  ecmwf_98=np.concatenate((ecmwf_98,ecmwf_98_a1))
  ecmwf_100=np.concatenate((ecmwf_100,ecmwf_100_a1))
  ecmwf_102=np.concatenate((ecmwf_102,ecmwf_102_a1))
  ecmwf_122=np.concatenate((ecmwf_122,ecmwf_122_a1))
  ecmwf_216=np.concatenate((ecmwf_216,ecmwf_216_a1))
  crtm_obs_28=np.concatenate((crtm_obs_28,crtm_obs_28_a1))
  crtm_obs_30=np.concatenate((crtm_obs_30,crtm_obs_30_a1))
  crtm_obs_32=np.concatenate((crtm_obs_32,crtm_obs_32_a1))
  crtm_obs_34=np.concatenate((crtm_obs_34,crtm_obs_34_a1))
  crtm_obs_36=np.concatenate((crtm_obs_36,crtm_obs_36_a1))
  crtm_obs_49=np.concatenate((crtm_obs_49,crtm_obs_49_a1))
  crtm_obs_51=np.concatenate((crtm_obs_51,crtm_obs_51_a1))
  crtm_obs_53=np.concatenate((crtm_obs_53,crtm_obs_53_a1))
  crtm_obs_55=np.concatenate((crtm_obs_55,crtm_obs_55_a1))
  crtm_obs_57=np.concatenate((crtm_obs_57,crtm_obs_57_a1))
  crtm_obs_65=np.concatenate((crtm_obs_65,crtm_obs_65_a1))
  crtm_obs_67=np.concatenate((crtm_obs_67,crtm_obs_67_a1))
  crtm_obs_69=np.concatenate((crtm_obs_69,crtm_obs_69_a1))
  crtm_obs_71=np.concatenate((crtm_obs_71,crtm_obs_71_a1))
  crtm_obs_73=np.concatenate((crtm_obs_73,crtm_obs_73_a1))
  crtm_obs_94=np.concatenate((crtm_obs_94,crtm_obs_94_a1))
  crtm_obs_96=np.concatenate((crtm_obs_96,crtm_obs_96_a1))
  crtm_obs_98=np.concatenate((crtm_obs_98,crtm_obs_98_a1))
  crtm_obs_100=np.concatenate((crtm_obs_100,crtm_obs_100_a1))
  crtm_obs_102=np.concatenate((crtm_obs_102,crtm_obs_102_a1))
  crtm_obs_122=np.concatenate((crtm_obs_122,crtm_obs_122_a1))
  crtm_obs_216=np.concatenate((crtm_obs_216,crtm_obs_216_a1))
  obs_28=np.concatenate((obs_28,obs_28_a1))
  obs_30=np.concatenate((obs_30,obs_30_a1))
  obs_32=np.concatenate((obs_32,obs_32_a1))
  obs_34=np.concatenate((obs_34,obs_34_a1))
  obs_36=np.concatenate((obs_36,obs_36_a1))
  obs_49=np.concatenate((obs_49,obs_49_a1))
  obs_51=np.concatenate((obs_51,obs_51_a1))
  obs_53=np.concatenate((obs_53,obs_53_a1))
  obs_55=np.concatenate((obs_55,obs_55_a1))
  obs_57=np.concatenate((obs_57,obs_57_a1))
  obs_65=np.concatenate((obs_65,obs_65_a1))
  obs_67=np.concatenate((obs_67,obs_67_a1))
  obs_69=np.concatenate((obs_69,obs_69_a1))
  obs_71=np.concatenate((obs_71,obs_71_a1))
  obs_73=np.concatenate((obs_73,obs_73_a1))
  obs_94=np.concatenate((obs_94,obs_94_a1))
  obs_96=np.concatenate((obs_96,obs_96_a1))
  obs_98=np.concatenate((obs_98,obs_98_a1))
  obs_100=np.concatenate((obs_100,obs_100_a1))
  obs_102=np.concatenate((obs_102,obs_102_a1))
  obs_122=np.concatenate((obs_122,obs_122_a1))
  obs_216=np.concatenate((obs_216,obs_216_a1))
 size=np.size(lat)
 file=open(output1,"w+")
 with open(output1,'wb') as f:
  for a in range(0,size):
   z=np.array([lat[a],lon[a],topo[a],forr[a],fov[a],lev[a],trop[a],ir[a],sum3[a],ctpc[a],ctpd[a],ctpv[a],ctpn[a],cotc[a],cotd[a],cotv[a],cotn[a],co2_28[a],co2_30[a],co2_32[a],co2_34[a],co2_36[a],co2_49[a],co2_51[a],co2_53[a],co2_55[a],co2_57[a],co2_65[a],co2_67[a],co2_69[a],co2_71[a],co2_73[a],co2_94[a],co2_96[a],co2_98[a],co2_100[a],co2_102[a],co2_122[a],ncep_28[a],ncep_30[a],ncep_32[a],ncep_34[a],ncep_36[a],ncep_49[a],ncep_51[a],ncep_53[a],ncep_55[a],ncep_57[a],ncep_65[a],ncep_67[a],ncep_69[a],ncep_71[a],ncep_73[a],ncep_94[a],ncep_96[a],ncep_98[a],ncep_100[a],ncep_102[a],ncep_122[a],ncep_216[a],ecmwf_28[a],ecmwf_30[a],ecmwf_32[a],ecmwf_34[a],ecmwf_36[a],ecmwf_49[a],ecmwf_51[a],ecmwf_53[a],ecmwf_55[a],ecmwf_57[a],ecmwf_65[a],ecmwf_67[a],ecmwf_69[a],ecmwf_71[a],ecmwf_73[a],ecmwf_94[a],ecmwf_96[a],ecmwf_98[a],ecmwf_100[a],ecmwf_102[a],ecmwf_122[a],ecmwf_216[a],crtm_obs_28[a],crtm_obs_30[a],crtm_obs_32[a],crtm_obs_34[a],crtm_obs_36[a],crtm_obs_49[a],crtm_obs_51[a],crtm_obs_53[a],crtm_obs_55[a],crtm_obs_57[a],crtm_obs_65[a],crtm_obs_67[a],crtm_obs_69[a],crtm_obs_71[a],crtm_obs_73[a],crtm_obs_94[a],crtm_obs_96[a],crtm_obs_98[a],crtm_obs_100[a],crtm_obs_102[a],crtm_obs_122[a],crtm_obs_216[a],obs_28[a],obs_30[a],obs_32[a],obs_34[a],obs_36[a],obs_49[a],obs_51[a],obs_53[a],obs_55[a],obs_57[a],obs_65[a],obs_67[a],obs_69[a],obs_71[a],obs_73[a],obs_94[a],obs_96[a],obs_98[a],obs_100[a],obs_102[a],obs_122[a],obs_216[a]])
   np.savetxt(f,z,fmt='%1.7f',newline=" ")
   np.savetxt(f,[-8888],fmt='%d',newline=" ")
 f.close()
 f=open(output1,"rt")
 r=f.read()
 r=r.replace("-8888","\n")
 r=r.replace(" -","-")
 r=r.replace("ift","888888")
 r=r.replace("nan","-9999")
 r=r.replace(" ",",")
 r=r.replace(","+"\n","\n")
 r=r.replace("\n"+",","\n")
 r=r.replace("0-","0,-")
 r=r.replace("1-","1,-")
 r=r.replace("2-","2,-")
 r=r.replace("3-","3,-")
 r=r.replace("4-","4,-")
 r=r.replace("5-","5,-")
 r=r.replace("6-","6,-")
 r=r.replace("7-","7,-")
 r=r.replace("8-","8,-")
 r=r.replace("9-","9,-")
 f.close()
 f=open(output1,"wt")
 f.write(r)
 f.close()

def full_comps_parts(st1,sp1,dt1,dt2,mon1,ye1):
 b1=int(st1)
 b2=int(sp1)
 b3=int(dt1)
 b4=int(dt2)
 b5=int(mon1)
 b6=int(ye1)
 if b1>=0 and b1<=9:
  c1="0"+str(b1)
 else:
  c1=str(b1)
 if b2>=0 and b2<=9:
  c2="0"+str(b2)
 else:
  c2=str(b2)
 if b3>=0 and b3<=9:
  c3="0"+str(b3)
 else:
  c3=str(b3)
 if b4>=0 and b4<=9:
  c4="0"+str(b4)
 else:
  c4=str(b4)
 if b5>=0 and b5<=9:
  c5="0"+str(b5)
 else:
  c5=str(b5)
 c6=str(b6)
 st=c1
 sp=c2
 dt=c3
 dp=c4
 mon=c5
 yer=c6
 day_time=(yer+"_"+mon+"_"+dt+"_"+st+"_"+sp)
 filepath=("/apollo/jung/bandersen")
 file_co2=(filepath+"/co2_slicing_full/"+yer+"_"+mon+"_"+dt+"/co2_slicing_output_"+yer+"_"+mon+"_"+dt+"_"+st+"00_"+st+"30.txt")
 array_co2_1=loadtxt(file_co2,comments='#',delimiter=',',unpack=True)
 file_co2=(filepath+"/co2_slicing_full/"+yer+"_"+mon+"_"+dt+"/co2_slicing_output_"+yer+"_"+mon+"_"+dt+"_"+st+"30_"+sp+"00.txt")
 array_co2_2=loadtxt(file_co2,comments='#',delimiter=',',unpack=True)
 array_ncep_1=cdf.Dataset(filepath+'/ncep_data_'+yer+'_'+mon+'_'+dt+'/cris.431.n20.'+yer+mon+dt+"_"+st+"0000."+yer+mon+dt+"_"+st+"3000.ncep.nc")
 array_ncep_2=cdf.Dataset(filepath+'/ncep_data_'+yer+'_'+mon+'_'+dt+'/cris.431.n20.'+yer+mon+dt+"_"+st+"3000."+yer+mon+dp+"_"+sp+"0000.ncep.nc")
 output=(filepath+"/compare_full/co2_ncep_output_"+day_time+".txt")
 ncep_1=array_ncep_1['lat'][:]
 ncep_2=array_ncep_2['lat'][:]
 lat_ncep=np.asarray(np.concatenate((ncep_1,ncep_2)))
 ncep_1=array_ncep_1['lon'][:]
 ncep_2=array_ncep_2['lon'][:]
 lon_ncep=np.asarray(np.concatenate((ncep_1,ncep_2)))
 ctp_ncep_1=array_ncep_1['ctp'][:]
 ctp_ncep_2=array_ncep_2['ctp'][:]
 ctp_ncep=np.asarray(np.concatenate((ctp_ncep_1,ctp_ncep_2)))
 cldfrac_ncep_1=array_ncep_1['cldfrac'][:]
 cldfrac_ncep_2=array_ncep_2['cldfrac'][:]
 cot_ncep=np.asarray(np.concatenate((cldfrac_ncep_1,cldfrac_ncep_2)))
 sum3_ncep_1=array_ncep_1['sum3'][:]
 sum3_ncep_2=array_ncep_2['sum3'][:]
 sum3_ncep=np.asarray(np.concatenate((sum3_ncep_1,sum3_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,28]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,28]
 ctag_ncep_28=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,30]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,30]
 ctag_ncep_30=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,32]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,32]
 ctag_ncep_32=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,34]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,34]
 ctag_ncep_34=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,36]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,36]
 ctag_ncep_36=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,49]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,49]
 ctag_ncep_49=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,51]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,51]
 ctag_ncep_51=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,53]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,53]
 ctag_ncep_53=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,55]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,55]
 ctag_ncep_55=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,57]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,57]
 ctag_ncep_57=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,65]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,65]
 ctag_ncep_65=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,67]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,67]
 ctag_ncep_67=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,69]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,69]
 ctag_ncep_69=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,71]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,71]
 ctag_ncep_71=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,73]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,73]
 ctag_ncep_73=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,94]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,94]
 ctag_ncep_94=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,96]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,96]
 ctag_ncep_96=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,98]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,98]
 ctag_ncep_98=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,100]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,100]
 ctag_ncep_100=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,102]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,102]
 ctag_ncep_102=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,122]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,122]
 ctag_ncep_122=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 cld_impacted_ncep_1=array_ncep_1['cld_impacted'][:,216]
 cld_impacted_ncep_2=array_ncep_2['cld_impacted'][:,216]
 ctag_ncep_216=np.asarray(np.concatenate((cld_impacted_ncep_1,cld_impacted_ncep_2)))
 lat_co2=np.asarray(np.concatenate((array_co2_1[0][:],array_co2_2[0][:])))
 lon_co2=np.asarray(np.concatenate((array_co2_1[1][:],array_co2_2[1][:])))
 topo=np.asarray(np.concatenate((array_co2_1[2][:],array_co2_2[2][:])))
 forr=np.asarray(np.concatenate((array_co2_1[3][:],array_co2_2[3][:])))
 fovv=np.asarray(np.concatenate((array_co2_1[4][:],array_co2_2[4][:])))
 ctp_viirs=np.asarray(np.concatenate((array_co2_1[5][:],array_co2_2[5][:])))
 cot_viirs=np.asarray(np.concatenate((array_co2_1[6][:],array_co2_2[6][:])))
 ctp_co2=np.asarray(np.concatenate((array_co2_1[7][:],array_co2_2[7][:])))
 cot_co2=np.asarray(np.concatenate((array_co2_1[8][:],array_co2_2[8][:])))
 lev_co2=np.asarray(np.concatenate((array_co2_1[9][:],array_co2_2[9][:])))
 trop=np.asarray(np.concatenate((array_co2_1[10][:],array_co2_2[10][:])))
 ir_test=np.asarray(np.concatenate((array_co2_1[11][:],array_co2_2[11][:])))
 co2_use_28=np.asarray(np.concatenate((array_co2_1[12][:],array_co2_2[12][:])))
 co2_use_30=np.asarray(np.concatenate((array_co2_1[13][:],array_co2_2[13][:])))
 co2_use_32=np.asarray(np.concatenate((array_co2_1[14][:],array_co2_2[14][:])))
 co2_use_34=np.asarray(np.concatenate((array_co2_1[15][:],array_co2_2[15][:])))
 co2_use_36=np.asarray(np.concatenate((array_co2_1[16][:],array_co2_2[16][:])))
 co2_use_49=np.asarray(np.concatenate((array_co2_1[17][:],array_co2_2[17][:])))
 co2_use_51=np.asarray(np.concatenate((array_co2_1[18][:],array_co2_2[18][:])))
 co2_use_53=np.asarray(np.concatenate((array_co2_1[19][:],array_co2_2[19][:])))
 co2_use_55=np.asarray(np.concatenate((array_co2_1[20][:],array_co2_2[20][:])))
 co2_use_57=np.asarray(np.concatenate((array_co2_1[21][:],array_co2_2[21][:])))
 co2_use_65=np.asarray(np.concatenate((array_co2_1[22][:],array_co2_2[22][:])))
 co2_use_67=np.asarray(np.concatenate((array_co2_1[23][:],array_co2_2[23][:])))
 co2_use_69=np.asarray(np.concatenate((array_co2_1[24][:],array_co2_2[24][:])))
 co2_use_71=np.asarray(np.concatenate((array_co2_1[25][:],array_co2_2[25][:])))
 co2_use_73=np.asarray(np.concatenate((array_co2_1[26][:],array_co2_2[26][:])))
 co2_use_94=np.asarray(np.concatenate((array_co2_1[27][:],array_co2_2[27][:])))
 co2_use_96=np.asarray(np.concatenate((array_co2_1[28][:],array_co2_2[28][:])))
 co2_use_98=np.asarray(np.concatenate((array_co2_1[29][:],array_co2_2[29][:])))
 co2_use_100=np.asarray(np.concatenate((array_co2_1[30][:],array_co2_2[30][:])))
 co2_use_102=np.asarray(np.concatenate((array_co2_1[31][:],array_co2_2[31][:])))
 co2_use_122=np.asarray(np.concatenate((array_co2_1[32][:],array_co2_2[32][:])))
 crtm_obs_28=np.asarray(np.concatenate((array_co2_1[33][:],array_co2_2[33][:])))
 crtm_obs_30=np.asarray(np.concatenate((array_co2_1[34][:],array_co2_2[34][:])))
 crtm_obs_32=np.asarray(np.concatenate((array_co2_1[35][:],array_co2_2[35][:])))
 crtm_obs_34=np.asarray(np.concatenate((array_co2_1[36][:],array_co2_2[36][:])))
 crtm_obs_36=np.asarray(np.concatenate((array_co2_1[37][:],array_co2_2[37][:])))
 crtm_obs_49=np.asarray(np.concatenate((array_co2_1[38][:],array_co2_2[38][:])))
 crtm_obs_51=np.asarray(np.concatenate((array_co2_1[39][:],array_co2_2[39][:])))
 crtm_obs_53=np.asarray(np.concatenate((array_co2_1[40][:],array_co2_2[40][:])))
 crtm_obs_55=np.asarray(np.concatenate((array_co2_1[41][:],array_co2_2[41][:])))
 crtm_obs_57=np.asarray(np.concatenate((array_co2_1[42][:],array_co2_2[42][:])))
 crtm_obs_65=np.asarray(np.concatenate((array_co2_1[43][:],array_co2_2[43][:])))
 crtm_obs_67=np.asarray(np.concatenate((array_co2_1[44][:],array_co2_2[44][:])))
 crtm_obs_69=np.asarray(np.concatenate((array_co2_1[45][:],array_co2_2[45][:])))
 crtm_obs_71=np.asarray(np.concatenate((array_co2_1[46][:],array_co2_2[46][:])))
 crtm_obs_73=np.asarray(np.concatenate((array_co2_1[47][:],array_co2_2[47][:])))
 crtm_obs_94=np.asarray(np.concatenate((array_co2_1[48][:],array_co2_2[48][:])))
 crtm_obs_96=np.asarray(np.concatenate((array_co2_1[49][:],array_co2_2[49][:])))
 crtm_obs_98=np.asarray(np.concatenate((array_co2_1[50][:],array_co2_2[50][:])))
 crtm_obs_100=np.asarray(np.concatenate((array_co2_1[51][:],array_co2_2[51][:])))
 crtm_obs_102=np.asarray(np.concatenate((array_co2_1[52][:],array_co2_2[52][:])))
 crtm_obs_122=np.asarray(np.concatenate((array_co2_1[53][:],array_co2_2[53][:])))
 crtm_obs_216=np.asarray(np.concatenate((array_co2_1[54][:],array_co2_2[54][:])))
 obs_28=np.asarray(np.concatenate((array_co2_1[55][:],array_co2_2[55][:])))
 obs_30=np.asarray(np.concatenate((array_co2_1[56][:],array_co2_2[56][:])))
 obs_32=np.asarray(np.concatenate((array_co2_1[57][:],array_co2_2[57][:])))
 obs_34=np.asarray(np.concatenate((array_co2_1[58][:],array_co2_2[58][:])))
 obs_36=np.asarray(np.concatenate((array_co2_1[59][:],array_co2_2[59][:])))
 obs_49=np.asarray(np.concatenate((array_co2_1[60][:],array_co2_2[60][:])))
 obs_51=np.asarray(np.concatenate((array_co2_1[61][:],array_co2_2[61][:])))
 obs_53=np.asarray(np.concatenate((array_co2_1[62][:],array_co2_2[62][:])))
 obs_55=np.asarray(np.concatenate((array_co2_1[63][:],array_co2_2[63][:])))
 obs_57=np.asarray(np.concatenate((array_co2_1[64][:],array_co2_2[64][:])))
 obs_65=np.asarray(np.concatenate((array_co2_1[65][:],array_co2_2[65][:])))
 obs_67=np.asarray(np.concatenate((array_co2_1[66][:],array_co2_2[66][:])))
 obs_69=np.asarray(np.concatenate((array_co2_1[67][:],array_co2_2[67][:])))
 obs_71=np.asarray(np.concatenate((array_co2_1[68][:],array_co2_2[68][:])))
 obs_73=np.asarray(np.concatenate((array_co2_1[69][:],array_co2_2[69][:])))
 obs_94=np.asarray(np.concatenate((array_co2_1[70][:],array_co2_2[70][:])))
 obs_96=np.asarray(np.concatenate((array_co2_1[71][:],array_co2_2[71][:])))
 obs_98=np.asarray(np.concatenate((array_co2_1[72][:],array_co2_2[72][:])))
 obs_100=np.asarray(np.concatenate((array_co2_1[73][:],array_co2_2[73][:])))
 obs_102=np.asarray(np.concatenate((array_co2_1[74][:],array_co2_2[74][:])))
 obs_122=np.asarray(np.concatenate((array_co2_1[75][:],array_co2_2[75][:])))
 obs_216=np.asarray(np.concatenate((array_co2_1[76][:],array_co2_2[76][:])))
 size_ncep=np.size(lat_ncep)
 def find_nearest(array,value):
  array=np.asarray(array)
  idx=(np.abs(array-value)).argmin()
  return array[idx]
 def find_nearest_index(array,value):
  array=np.asarray(array)
  idx=(np.abs(array-value)).argmin()
  return(idx)
 lat_all=[]
 lon_all=[]
 topo_all=[]
 for_all=[]
 fov_all=[]
 lev_all=[]
 trop_all=[]
 ir_all=[]
 co2_ctp_all=[]
 viirs_ctp_all=[]
 ncep_ctp_all=[]
 co2_cot_all=[]
 viirs_cot_all=[]
 ncep_cot_all=[]
 ncep_sum3_all=[]
 co2_28_all=[]
 co2_30_all=[]
 co2_32_all=[]
 co2_34_all=[]
 co2_36_all=[]
 co2_49_all=[]
 co2_51_all=[]
 co2_53_all=[]
 co2_55_all=[]
 co2_57_all=[]
 co2_65_all=[]
 co2_67_all=[]
 co2_69_all=[]
 co2_71_all=[]
 co2_73_all=[]
 co2_94_all=[]
 co2_96_all=[]
 co2_98_all=[]
 co2_100_all=[]
 co2_102_all=[]
 co2_122_all=[]
 ncep_28_all=[]
 ncep_30_all=[]
 ncep_32_all=[]
 ncep_34_all=[]
 ncep_36_all=[]
 ncep_49_all=[]
 ncep_51_all=[]
 ncep_53_all=[]
 ncep_55_all=[]
 ncep_57_all=[]
 ncep_65_all=[]
 ncep_67_all=[]
 ncep_69_all=[]
 ncep_71_all=[]
 ncep_73_all=[]
 ncep_94_all=[]
 ncep_96_all=[]
 ncep_98_all=[]
 ncep_100_all=[]
 ncep_102_all=[]
 ncep_122_all=[]
 ncep_216_all=[]
 crtm_obs_28_all=[]
 crtm_obs_30_all=[]
 crtm_obs_32_all=[]
 crtm_obs_34_all=[]
 crtm_obs_36_all=[]
 crtm_obs_49_all=[]
 crtm_obs_51_all=[]
 crtm_obs_53_all=[]
 crtm_obs_55_all=[]
 crtm_obs_57_all=[]
 crtm_obs_65_all=[]
 crtm_obs_67_all=[]
 crtm_obs_69_all=[]
 crtm_obs_71_all=[]
 crtm_obs_73_all=[]
 crtm_obs_94_all=[]
 crtm_obs_96_all=[]
 crtm_obs_98_all=[]
 crtm_obs_100_all=[]
 crtm_obs_102_all=[]
 crtm_obs_122_all=[]
 crtm_obs_216_all=[]
 obs_28_all=[]
 obs_30_all=[]
 obs_32_all=[]
 obs_34_all=[]
 obs_36_all=[]
 obs_49_all=[]
 obs_51_all=[]
 obs_53_all=[]
 obs_55_all=[]
 obs_57_all=[]
 obs_65_all=[]
 obs_67_all=[]
 obs_69_all=[]
 obs_71_all=[]
 obs_73_all=[]
 obs_94_all=[]
 obs_96_all=[]
 obs_98_all=[]
 obs_100_all=[]
 obs_102_all=[]
 obs_122_all=[]
 obs_216_all=[]
 for a1 in range(0,size_ncep):
  a_val=find_nearest(lat_co2,lat_ncep[a1])
  a_co2=find_nearest_index(lat_co2,a_val)
  a_ncep=find_nearest_index(lat_ncep,a_val)
  b1=lat_f[a_co2]
  b2=lon_f[a_co2]
  c1=topo[a_co2]
  c2=forr[a_co2]
  c3=fovv[a_co2]
  d1=lev_co2[a_co2]
  d2=trop[a_co2]
  d3=ir_test[a_co2]
  d4=sum3_ncep[a_ncep]
  e1=ctp_co2[a_co2]
  e3=ctp_viirs[a_co2]
  e4=ctp_ncep[a_ncep]
  g1=cot_co2[a_co2]
  g3=cot_viirs[a_co2]
  g4=cot_ncep[a_ncep]
  h1=co2_use_28[a_co2]
  h2=co2_use_30[a_co2]
  h3=co2_use_32[a_co2]
  h4=co2_use_34[a_co2]
  h5=co2_use_36[a_co2]
  h6=co2_use_49[a_co2]
  h7=co2_use_51[a_co2]
  h8=co2_use_53[a_co2]
  h9=co2_use_55[a_co2]
  h10=co2_use_57[a_co2]
  h11=co2_use_65[a_co2]
  h12=co2_use_67[a_co2]
  h13=co2_use_69[a_co2]
  h14=co2_use_71[a_co2]
  h15=co2_use_73[a_co2]
  h16=co2_use_94[a_co2]
  h17=co2_use_96[a_co2]
  h18=co2_use_98[a_co2]
  h19=co2_use_100[a_co2]
  h20=co2_use_102[a_co2]
  h21=co2_use_122[a_co2]
  j1=ctag_ncep_28[a_ncep]
  j2=ctag_ncep_30[a_ncep]
  j3=ctag_ncep_32[a_ncep]
  j4=ctag_ncep_34[a_ncep]
  j5=ctag_ncep_36[a_ncep]
  j6=ctag_ncep_49[a_ncep]
  j7=ctag_ncep_51[a_ncep]
  j8=ctag_ncep_53[a_ncep]
  j9=ctag_ncep_55[a_ncep]
  j10=ctag_ncep_57[a_ncep]
  j11=ctag_ncep_65[a_ncep]
  j12=ctag_ncep_67[a_ncep]
  j13=ctag_ncep_69[a_ncep]
  j14=ctag_ncep_71[a_ncep]
  j15=ctag_ncep_73[a_ncep]
  j16=ctag_ncep_94[a_ncep]
  j17=ctag_ncep_96[a_ncep]
  j18=ctag_ncep_98[a_ncep]
  j19=ctag_ncep_100[a_ncep]
  j20=ctag_ncep_102[a_ncep]
  j21=ctag_ncep_122[a_ncep]
  j22=ctag_ncep_216[a_ncep]
  l1=crtm_obs_28[a_co2]
  l2=crtm_obs_30[a_co2]
  l3=crtm_obs_32[a_co2]
  l4=crtm_obs_34[a_co2]
  l5=crtm_obs_36[a_co2]
  l6=crtm_obs_49[a_co2]
  l7=crtm_obs_51[a_co2]
  l8=crtm_obs_53[a_co2]
  l9=crtm_obs_55[a_co2]
  l10=crtm_obs_57[a_co2]
  l11=crtm_obs_65[a_co2]
  l12=crtm_obs_67[a_co2]
  l13=crtm_obs_69[a_co2]
  l14=crtm_obs_71[a_co2]
  l15=crtm_obs_73[a_co2]
  l16=crtm_obs_94[a_co2]
  l17=crtm_obs_96[a_co2]
  l18=crtm_obs_98[a_co2]
  l19=crtm_obs_100[a_co2]
  l20=crtm_obs_102[a_co2]
  l21=crtm_obs_122[a_co2]
  l22=crtm_obs_216[a_co2]
  m1=obs_28[a_co2]
  m2=obs_30[a_co2]
  m3=obs_32[a_co2]
  m4=obs_34[a_co2]
  m5=obs_36[a_co2]
  m6=obs_49[a_co2]
  m7=obs_51[a_co2]
  m8=obs_53[a_co2]
  m9=obs_55[a_co2]
  m10=obs_57[a_co2]
  m11=obs_65[a_co2]
  m12=obs_67[a_co2]
  m13=obs_69[a_co2]
  m14=obs_71[a_co2]
  m15=obs_73[a_co2]
  m16=obs_94[a_co2]
  m17=obs_96[a_co2]
  m18=obs_98[a_co2]
  m19=obs_100[a_co2]
  m20=obs_102[a_co2]
  m21=obs_122[a_co2]
  m22=obs_216[a_co2]
  lat_all.append(b1)
  lon_all.append(b2)
  topo_all.append(c1)
  for_all.append(c2)
  fov_all.append(c3)
  lev_all.append(d1)
  trop_all.append(d2)
  ir_all.append(d3)
  ncep_sum3_all.append(d4)
  co2_ctp_all.append(e1)
  viirs_ctp_all.append(e3)
  ncep_ctp_all.append(e4)
  co2_cot_all.append(g1)
  viirs_cot_all.append(g3)
  ncep_cot_all.append(g4)
  co2_28_all.append(h1)
  co2_30_all.append(h2)
  co2_32_all.append(h3)
  co2_34_all.append(h4)
  co2_36_all.append(h5)
  co2_49_all.append(h6)
  co2_51_all.append(h7)
  co2_53_all.append(h8)
  co2_55_all.append(h9)
  co2_57_all.append(h10)
  co2_65_all.append(h11)
  co2_67_all.append(h12)
  co2_69_all.append(h13)
  co2_71_all.append(h14)
  co2_73_all.append(h15)
  co2_94_all.append(h16)
  co2_96_all.append(h17)
  co2_98_all.append(h18)
  co2_100_all.append(h19)
  co2_102_all.append(h20)
  co2_122_all.append(h21)
  ncep_28_all.append(j1)
  ncep_30_all.append(j2)
  ncep_32_all.append(j3)
  ncep_34_all.append(j4)
  ncep_36_all.append(j5)
  ncep_49_all.append(j6)
  ncep_51_all.append(j7)
  ncep_53_all.append(j8)
  ncep_55_all.append(j9)
  ncep_57_all.append(j10)
  ncep_65_all.append(j11)
  ncep_67_all.append(j12)
  ncep_69_all.append(j13)
  ncep_71_all.append(j14)
  ncep_73_all.append(j15)
  ncep_94_all.append(j16)
  ncep_96_all.append(j17)
  ncep_98_all.append(j18)
  ncep_100_all.append(j19)
  ncep_102_all.append(j20)
  ncep_122_all.append(j21)
  ncep_216_all.append(j22)
  crtm_obs_28_all.append(l1)
  crtm_obs_30_all.append(l2)
  crtm_obs_32_all.append(l3)
  crtm_obs_34_all.append(l4)
  crtm_obs_36_all.append(l5)
  crtm_obs_49_all.append(l6)
  crtm_obs_51_all.append(l7)
  crtm_obs_53_all.append(l8)
  crtm_obs_55_all.append(l9)
  crtm_obs_57_all.append(l10)
  crtm_obs_65_all.append(l11)
  crtm_obs_67_all.append(l12)
  crtm_obs_69_all.append(l13)
  crtm_obs_71_all.append(l14)
  crtm_obs_73_all.append(l15)
  crtm_obs_94_all.append(l16)
  crtm_obs_96_all.append(l17)
  crtm_obs_98_all.append(l18)
  crtm_obs_100_all.append(l19)
  crtm_obs_102_all.append(l20)
  crtm_obs_122_all.append(l21)
  crtm_obs_216_all.append(l22)
  obs_28_all.append(m1)
  obs_30_all.append(m2)
  obs_32_all.append(m3)
  obs_34_all.append(m4)
  obs_36_all.append(m5)
  obs_49_all.append(m6)
  obs_51_all.append(m7)
  obs_53_all.append(m8)
  obs_55_all.append(m9)
  obs_57_all.append(m10)
  obs_65_all.append(m11)
  obs_67_all.append(m12)
  obs_69_all.append(m13)
  obs_71_all.append(m14)
  obs_73_all.append(m15)
  obs_94_all.append(m16)
  obs_96_all.append(m17)
  obs_98_all.append(m18)
  obs_100_all.append(m19)
  obs_102_all.append(m20)
  obs_122_all.append(m21)
  obs_216_all.append(m22)
 size=np.size(lat_all)
 file=open(output,"w+")
 with open(output,'wb') as f:
  for a in range(0,size):
   z=np.array([lat_all[a],lon_all[a],topo_all[a],for_all[a],fov_all[a],lev_all[a],trop_all[a],ir_all[a],ncep_sum3_all[a],co2_ctp_all[a],viirs_ctp_all[a],ncep_ctp_all[a],co2_cot_all[a],viirs_cot_all[a],ncep_cot_all[a],co2_28_all[a],co2_30_all[a],co2_32_all[a],co2_34_all[a],co2_36_all[a],co2_49_all[a],co2_51_all[a],co2_53_all[a],co2_55_all[a],co2_57_all[a],co2_65_all[a],co2_67_all[a],co2_69_all[a],co2_71_all[a],co2_73_all[a],co2_94_all[a],co2_96_all[a],co2_98_all[a],co2_100_all[a],co2_102_all[a],co2_122_all[a],ncep_28_all[a],ncep_30_all[a],ncep_32_all[a],ncep_34_all[a],ncep_36_all[a],ncep_49_all[a],ncep_51_all[a],ncep_53_all[a],ncep_55_all[a],ncep_57_all[a],ncep_65_all[a],ncep_67_all[a],ncep_69_all[a],ncep_71_all[a],ncep_73_all[a],ncep_94_all[a],ncep_96_all[a],ncep_98_all[a],ncep_100_all[a],ncep_102_all[a],ncep_122_all[a],ncep_216_all[a],crtm_obs_28_all[a],crtm_obs_30_all[a],crtm_obs_32_all[a],crtm_obs_34_all[a],crtm_obs_36_all[a],crtm_obs_49_all[a],crtm_obs_51_all[a],crtm_obs_53_all[a],crtm_obs_55_all[a],crtm_obs_57_all[a],crtm_obs_65_all[a],crtm_obs_67_all[a],crtm_obs_69_all[a],crtm_obs_71_all[a],crtm_obs_73_all[a],crtm_obs_94_all[a],crtm_obs_96_all[a],crtm_obs_98_all[a],crtm_obs_100_all[a],crtm_obs_102_all[a],crtm_obs_122_all[a],crtm_obs_216_all[a],obs_28_all[a],obs_30_all[a],obs_32_all[a],obs_34_all[a],obs_36_all[a],obs_49_all[a],obs_51_all[a],obs_53_all[a],obs_55_all[a],obs_57_all[a],obs_65_all[a],obs_67_all[a],obs_69_all[a],obs_71_all[a],obs_73_all[a],obs_94_all[a],obs_96_all[a],obs_98_all[a],obs_100_all[a],obs_102_all[a],obs_122_all[a],obs_216_all[a]])
   np.savetxt(f,z,fmt='%1.7f',newline=" ")
   np.savetxt(f,[-8888],fmt='%d',newline=" ")
 f.close()
 f=open(output,"rt")
 r=f.read()
 r=r.replace("-8888","\n")
 r=r.replace(" -","-")
 r=r.replace("ift","797979")
 r=r.replace("inf","797979")
 r=r.replace("nan","-9999")
 r=r.replace(" ",",")
 r=r.replace(","+"\n","\n")
 r=r.replace("\n"+",","\n")
 r=r.replace("0-","0,-")
 r=r.replace("1-","1,-")
 r=r.replace("2-","2,-")
 r=r.replace("3-","3,-")
 r=r.replace("4-","4,-")
 r=r.replace("5-","5,-")
 r=r.replace("6-","6,-")
 r=r.replace("7-","7,-")
 r=r.replace("8-","8,-")
 r=r.replace("9-","9,-")
 f.close()
 f=open(output,"wt")
 f.write(r)
 f.close()
 return("done")

def comps_hour_parts(dt1,mon1,ye1):
 b1=int(dt1)
 b2=int(mon1)
 b3=int(ye1)
 if b1>=0 and b1<=9:
  c1="0"+str(b1)
 else:
  c1=str(b1)
 if b2>=0 and b2<=9:
  c2="0"+str(b2)
 else:
  c2=str(b2)
 c3=str(b3)
 dd=c1
 mon=c2
 yer=c3
 output1=('/apollo/jung/bandersen/compare_full_no_parts/co2_ncep_output_'+yer+'_'+mon+'_'+dd+'_24hr.txt')
 files=glob('/apollo/jung/bandersen/compare_full/co2_ncep_output_'+yer+'_'+mon+'_'+dd+'*.txt')[:]
 sizer=np.size(files)
 lat=[]
 lon=[]
 topo=[]
 forr=[]
 fov=[]
 lev=[]
 trop=[]
 ir=[]
 sum3=[]
 ctpc=[]
 ctpv=[]
 ctpn=[]
 cotc=[]
 cotv=[]
 cotn=[]
 co2_28=[]
 co2_30=[]
 co2_32=[]
 co2_34=[]
 co2_36=[]
 co2_49=[]
 co2_51=[]
 co2_53=[]
 co2_55=[]
 co2_57=[]
 co2_65=[]
 co2_67=[]
 co2_69=[]
 co2_71=[]
 co2_73=[]
 co2_94=[]
 co2_96=[]
 co2_98=[]
 co2_100=[]
 co2_102=[]
 co2_122=[]
 ncep_28=[]
 ncep_30=[]
 ncep_32=[]
 ncep_34=[]
 ncep_36=[]
 ncep_49=[]
 ncep_51=[]
 ncep_53=[]
 ncep_55=[]
 ncep_57=[]
 ncep_65=[]
 ncep_67=[]
 ncep_69=[]
 ncep_71=[]
 ncep_73=[]
 ncep_94=[]
 ncep_96=[]
 ncep_98=[]
 ncep_100=[]
 ncep_102=[]
 ncep_122=[]
 ncep_216=[]
 crtm_obs_28=[]
 crtm_obs_30=[]
 crtm_obs_32=[]
 crtm_obs_34=[]
 crtm_obs_36=[]
 crtm_obs_49=[]
 crtm_obs_51=[]
 crtm_obs_53=[]
 crtm_obs_55=[]
 crtm_obs_57=[]
 crtm_obs_65=[]
 crtm_obs_67=[]
 crtm_obs_69=[]
 crtm_obs_71=[]
 crtm_obs_73=[]
 crtm_obs_94=[]
 crtm_obs_96=[]
 crtm_obs_98=[]
 crtm_obs_100=[]
 crtm_obs_102=[]
 crtm_obs_122=[]
 crtm_obs_216=[]
 obs_28=[]
 obs_30=[]
 obs_32=[]
 obs_34=[]
 obs_36=[]
 obs_49=[]
 obs_51=[]
 obs_53=[]
 obs_55=[]
 obs_57=[]
 obs_65=[]
 obs_67=[]
 obs_69=[]
 obs_71=[]
 obs_73=[]
 obs_94=[]
 obs_96=[]
 obs_98=[]
 obs_100=[]
 obs_102=[]
 obs_122=[]
 obs_216=[]
 for i in range(0,sizer):
  array_a1=loadtxt(files[i],comments='#',delimiter=',',unpack=True)
  lat_a1=array_a1[0][:]
  lon_a1=array_a1[1][:]
  topo_a1=array_a1[2][:]
  forr_a1=array_a1[3][:]
  fov_a1=array_a1[4][:]
  lev_a1=array_a1[5][:]
  trop_a1=array_a1[6][:]
  ir_a1=array_a1[7][:]
  sum3_a1=array_a1[8][:]
  ctpc_a1=array_a1[9][:]
  ctpv_a1=array_a1[11][:]
  ctpn_a1=array_a1[12][:]
  cotc_a1=array_a1[13][:]
  cotv_a1=array_a1[15][:]
  cotn_a1=array_a1[16][:]
  co2_28_a1=array_a1[17][:]
  co2_30_a1=array_a1[18][:]
  co2_32_a1=array_a1[19][:]
  co2_34_a1=array_a1[20][:]
  co2_36_a1=array_a1[21][:]
  co2_49_a1=array_a1[22][:]
  co2_51_a1=array_a1[23][:]
  co2_53_a1=array_a1[24][:]
  co2_55_a1=array_a1[25][:]
  co2_57_a1=array_a1[26][:]
  co2_65_a1=array_a1[27][:]
  co2_67_a1=array_a1[28][:]
  co2_69_a1=array_a1[29][:]
  co2_71_a1=array_a1[30][:]
  co2_73_a1=array_a1[31][:]
  co2_94_a1=array_a1[32][:]
  co2_96_a1=array_a1[33][:]
  co2_98_a1=array_a1[34][:]
  co2_100_a1=array_a1[35][:]
  co2_102_a1=array_a1[36][:]
  co2_122_a1=array_a1[37][:]
  ncep_28_a1=array_a1[38][:]
  ncep_30_a1=array_a1[39][:]
  ncep_32_a1=array_a1[40][:]
  ncep_34_a1=array_a1[41][:]
  ncep_36_a1=array_a1[42][:]
  ncep_49_a1=array_a1[43][:]
  ncep_51_a1=array_a1[44][:]
  ncep_53_a1=array_a1[45][:]
  ncep_55_a1=array_a1[46][:]
  ncep_57_a1=array_a1[47][:]
  ncep_65_a1=array_a1[48][:]
  ncep_67_a1=array_a1[49][:]
  ncep_69_a1=array_a1[50][:]
  ncep_71_a1=array_a1[51][:]
  ncep_73_a1=array_a1[52][:]
  ncep_94_a1=array_a1[53][:]
  ncep_96_a1=array_a1[54][:]
  ncep_98_a1=array_a1[55][:]
  ncep_100_a1=array_a1[56][:]
  ncep_102_a1=array_a1[57][:]
  ncep_122_a1=array_a1[58][:]
  ncep_216_a1=array_a1[59][:]
  crtm_obs_28_a1=array_a1[82][:]
  crtm_obs_30_a1=array_a1[83][:]
  crtm_obs_32_a1=array_a1[84][:]
  crtm_obs_34_a1=array_a1[85][:]
  crtm_obs_36_a1=array_a1[86][:]
  crtm_obs_49_a1=array_a1[87][:]
  crtm_obs_51_a1=array_a1[88][:]
  crtm_obs_53_a1=array_a1[89][:]
  crtm_obs_55_a1=array_a1[90][:]
  crtm_obs_57_a1=array_a1[91][:]
  crtm_obs_65_a1=array_a1[92][:]
  crtm_obs_67_a1=array_a1[93][:]
  crtm_obs_69_a1=array_a1[94][:]
  crtm_obs_71_a1=array_a1[95][:]
  crtm_obs_73_a1=array_a1[96][:]
  crtm_obs_94_a1=array_a1[97][:]
  crtm_obs_96_a1=array_a1[98][:]
  crtm_obs_98_a1=array_a1[99][:]
  crtm_obs_100_a1=array_a1[100][:]
  crtm_obs_102_a1=array_a1[101][:]
  crtm_obs_122_a1=array_a1[102][:]
  crtm_obs_216_a1=array_a1[103][:]
  obs_28_a1=array_a1[104][:]
  obs_30_a1=array_a1[105][:]
  obs_32_a1=array_a1[106][:]
  obs_34_a1=array_a1[107][:]
  obs_36_a1=array_a1[108][:]
  obs_49_a1=array_a1[109][:]
  obs_51_a1=array_a1[110][:]
  obs_53_a1=array_a1[111][:]
  obs_55_a1=array_a1[112][:]
  obs_57_a1=array_a1[113][:]
  obs_65_a1=array_a1[114][:]
  obs_67_a1=array_a1[115][:]
  obs_69_a1=array_a1[116][:]
  obs_71_a1=array_a1[117][:]
  obs_73_a1=array_a1[118][:]
  obs_94_a1=array_a1[119][:]
  obs_96_a1=array_a1[120][:]
  obs_98_a1=array_a1[121][:]
  obs_100_a1=array_a1[122][:]
  obs_102_a1=array_a1[123][:]
  obs_122_a1=array_a1[124][:]
  obs_216_a1=array_a1[125][:]
  lat=np.concatenate((lat,lat_a1))
  lon=np.concatenate((lon,lon_a1))
  topo=np.concatenate((topo,topo_a1))
  forr=np.concatenate((forr,forr_a1))
  fov=np.concatenate((fov,fov_a1))
  lev=np.concatenate((lev,lev_a1))
  trop=np.concatenate((trop,trop_a1))
  ir=np.concatenate((ir,ir_a1))
  sum3=np.concatenate((sum3,sum3_a1))
  ctpc=np.concatenate((ctpc,ctpc_a1))
  ctpv=np.concatenate((ctpv,ctpv_a1))
  ctpn=np.concatenate((ctpn,ctpn_a1))
  cotc=np.concatenate((cotc,cotc_a1))
  cotv=np.concatenate((cotv,cotv_a1))
  cotn=np.concatenate((cotn,cotn_a1))
  co2_28=np.concatenate((co2_28,co2_28_a1))
  co2_30=np.concatenate((co2_30,co2_30_a1))
  co2_32=np.concatenate((co2_32,co2_32_a1))
  co2_34=np.concatenate((co2_34,co2_34_a1))
  co2_36=np.concatenate((co2_36,co2_36_a1))
  co2_49=np.concatenate((co2_49,co2_49_a1))
  co2_51=np.concatenate((co2_51,co2_51_a1))
  co2_53=np.concatenate((co2_53,co2_53_a1))
  co2_55=np.concatenate((co2_55,co2_55_a1))
  co2_57=np.concatenate((co2_57,co2_57_a1))
  co2_65=np.concatenate((co2_65,co2_65_a1))
  co2_67=np.concatenate((co2_67,co2_67_a1))
  co2_69=np.concatenate((co2_69,co2_69_a1))
  co2_71=np.concatenate((co2_71,co2_71_a1))
  co2_73=np.concatenate((co2_73,co2_73_a1))
  co2_94=np.concatenate((co2_94,co2_94_a1))
  co2_96=np.concatenate((co2_96,co2_96_a1))
  co2_98=np.concatenate((co2_98,co2_98_a1))
  co2_100=np.concatenate((co2_100,co2_100_a1))
  co2_102=np.concatenate((co2_102,co2_102_a1))
  co2_122=np.concatenate((co2_122,co2_122_a1))
  ncep_28=np.concatenate((ncep_28,ncep_28_a1))
  ncep_30=np.concatenate((ncep_30,ncep_30_a1))
  ncep_32=np.concatenate((ncep_32,ncep_32_a1))
  ncep_34=np.concatenate((ncep_34,ncep_34_a1))
  ncep_36=np.concatenate((ncep_36,ncep_36_a1))
  ncep_49=np.concatenate((ncep_49,ncep_49_a1))
  ncep_51=np.concatenate((ncep_51,ncep_51_a1))
  ncep_53=np.concatenate((ncep_53,ncep_53_a1))
  ncep_55=np.concatenate((ncep_55,ncep_55_a1))
  ncep_57=np.concatenate((ncep_57,ncep_57_a1))
  ncep_65=np.concatenate((ncep_65,ncep_65_a1))
  ncep_67=np.concatenate((ncep_67,ncep_67_a1))
  ncep_69=np.concatenate((ncep_69,ncep_69_a1))
  ncep_71=np.concatenate((ncep_71,ncep_71_a1))
  ncep_73=np.concatenate((ncep_73,ncep_73_a1))
  ncep_94=np.concatenate((ncep_94,ncep_94_a1))
  ncep_96=np.concatenate((ncep_96,ncep_96_a1))
  ncep_98=np.concatenate((ncep_98,ncep_98_a1))
  ncep_100=np.concatenate((ncep_100,ncep_100_a1))
  ncep_102=np.concatenate((ncep_102,ncep_102_a1))
  ncep_122=np.concatenate((ncep_122,ncep_122_a1))
  ncep_216=np.concatenate((ncep_216,ncep_216_a1))
  crtm_obs_28=np.concatenate((crtm_obs_28,crtm_obs_28_a1))
  crtm_obs_30=np.concatenate((crtm_obs_30,crtm_obs_30_a1))
  crtm_obs_32=np.concatenate((crtm_obs_32,crtm_obs_32_a1))
  crtm_obs_34=np.concatenate((crtm_obs_34,crtm_obs_34_a1))
  crtm_obs_36=np.concatenate((crtm_obs_36,crtm_obs_36_a1))
  crtm_obs_49=np.concatenate((crtm_obs_49,crtm_obs_49_a1))
  crtm_obs_51=np.concatenate((crtm_obs_51,crtm_obs_51_a1))
  crtm_obs_53=np.concatenate((crtm_obs_53,crtm_obs_53_a1))
  crtm_obs_55=np.concatenate((crtm_obs_55,crtm_obs_55_a1))
  crtm_obs_57=np.concatenate((crtm_obs_57,crtm_obs_57_a1))
  crtm_obs_65=np.concatenate((crtm_obs_65,crtm_obs_65_a1))
  crtm_obs_67=np.concatenate((crtm_obs_67,crtm_obs_67_a1))
  crtm_obs_69=np.concatenate((crtm_obs_69,crtm_obs_69_a1))
  crtm_obs_71=np.concatenate((crtm_obs_71,crtm_obs_71_a1))
  crtm_obs_73=np.concatenate((crtm_obs_73,crtm_obs_73_a1))
  crtm_obs_94=np.concatenate((crtm_obs_94,crtm_obs_94_a1))
  crtm_obs_96=np.concatenate((crtm_obs_96,crtm_obs_96_a1))
  crtm_obs_98=np.concatenate((crtm_obs_98,crtm_obs_98_a1))
  crtm_obs_100=np.concatenate((crtm_obs_100,crtm_obs_100_a1))
  crtm_obs_102=np.concatenate((crtm_obs_102,crtm_obs_102_a1))
  crtm_obs_122=np.concatenate((crtm_obs_122,crtm_obs_122_a1))
  crtm_obs_216=np.concatenate((crtm_obs_216,crtm_obs_216_a1))
  obs_28=np.concatenate((obs_28,obs_28_a1))
  obs_30=np.concatenate((obs_30,obs_30_a1))
  obs_32=np.concatenate((obs_32,obs_32_a1))
  obs_34=np.concatenate((obs_34,obs_34_a1))
  obs_36=np.concatenate((obs_36,obs_36_a1))
  obs_49=np.concatenate((obs_49,obs_49_a1))
  obs_51=np.concatenate((obs_51,obs_51_a1))
  obs_53=np.concatenate((obs_53,obs_53_a1))
  obs_55=np.concatenate((obs_55,obs_55_a1))
  obs_57=np.concatenate((obs_57,obs_57_a1))
  obs_65=np.concatenate((obs_65,obs_65_a1))
  obs_67=np.concatenate((obs_67,obs_67_a1))
  obs_69=np.concatenate((obs_69,obs_69_a1))
  obs_71=np.concatenate((obs_71,obs_71_a1))
  obs_73=np.concatenate((obs_73,obs_73_a1))
  obs_94=np.concatenate((obs_94,obs_94_a1))
  obs_96=np.concatenate((obs_96,obs_96_a1))
  obs_98=np.concatenate((obs_98,obs_98_a1))
  obs_100=np.concatenate((obs_100,obs_100_a1))
  obs_102=np.concatenate((obs_102,obs_102_a1))
  obs_122=np.concatenate((obs_122,obs_122_a1))
  obs_216=np.concatenate((obs_216,obs_216_a1))
 size=np.size(lat)
 file=open(output1,"w+")
 with open(output1,'wb') as f:
  for a in range(0,size):
   z=np.array([lat[a],lon[a],topo[a],forr[a],fov[a],lev[a],trop[a],ir[a],sum3[a],ctpc[a],ctpv[a],ctpn[a],cotc[a],cotv[a],cotn[a],co2_28[a],co2_30[a],co2_32[a],co2_34[a],co2_36[a],co2_49[a],co2_51[a],co2_53[a],co2_55[a],co2_57[a],co2_65[a],co2_67[a],co2_69[a],co2_71[a],co2_73[a],co2_94[a],co2_96[a],co2_98[a],co2_100[a],co2_102[a],co2_122[a],ncep_28[a],ncep_30[a],ncep_32[a],ncep_34[a],ncep_36[a],ncep_49[a],ncep_51[a],ncep_53[a],ncep_55[a],ncep_57[a],ncep_65[a],ncep_67[a],ncep_69[a],ncep_71[a],ncep_73[a],ncep_94[a],ncep_96[a],ncep_98[a],ncep_100[a],ncep_102[a],ncep_122[a],ncep_216[a],crtm_obs_28[a],crtm_obs_30[a],crtm_obs_32[a],crtm_obs_34[a],crtm_obs_36[a],crtm_obs_49[a],crtm_obs_51[a],crtm_obs_53[a],crtm_obs_55[a],crtm_obs_57[a],crtm_obs_65[a],crtm_obs_67[a],crtm_obs_69[a],crtm_obs_71[a],crtm_obs_73[a],crtm_obs_94[a],crtm_obs_96[a],crtm_obs_98[a],crtm_obs_100[a],crtm_obs_102[a],crtm_obs_122[a],crtm_obs_216[a],obs_28[a],obs_30[a],obs_32[a],obs_34[a],obs_36[a],obs_49[a],obs_51[a],obs_53[a],obs_55[a],obs_57[a],obs_65[a],obs_67[a],obs_69[a],obs_71[a],obs_73[a],obs_94[a],obs_96[a],obs_98[a],obs_100[a],obs_102[a],obs_122[a],obs_216[a]])
   np.savetxt(f,z,fmt='%1.7f',newline=" ")
   np.savetxt(f,[-8888],fmt='%d',newline=" ")
 f.close()
 f=open(output1,"rt")
 r=f.read()
 r=r.replace("-8888","\n")
 r=r.replace(" -","-")
 r=r.replace("ift","888888")
 r=r.replace("nan","-9999")
 r=r.replace(" ",",")
 r=r.replace(","+"\n","\n")
 r=r.replace("\n"+",","\n")
 r=r.replace("0-","0,-")
 r=r.replace("1-","1,-")
 r=r.replace("2-","2,-")
 r=r.replace("3-","3,-")
 r=r.replace("4-","4,-")
 r=r.replace("5-","5,-")
 r=r.replace("6-","6,-")
 r=r.replace("7-","7,-")
 r=r.replace("8-","8,-")
 r=r.replace("9-","9,-")
 f.close()
 f=open(output1,"wt")
 f.write(r)
 f.close()

